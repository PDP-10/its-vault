TITLE TTYTST
A=1B=2C=3D=4P=17
.IOTI=1_33SIXIN=2_33SIXOUT=3_33SIXSP=4_33
GO:	MOVEI P,PDL-1
	.OPEN 1,.+1
	SIXBIT /   TTY/
	.OPEN 2,.+1
	SIXBIT /  !TTY/
	.RDATI B,
	MOVEM B,TIME
	MOVEM C,DATE'
	SIXOUT [SIXBIT /GOOD @/]
	LDB A,[360200,,TIME']
	LDB B,[300400,,TIME]
	IMULI A,10.
	SUBI A,7
	ADD A,B
	SKIPGE A
	MOVEI A,15.
	IDIVI A,5
	SKIPGE TIME
	MOVEI A,4
	SIXOUT @GRTAB(A)
	.SUSET [.RUNAM,,A]
	MOVSI B,-NNAMS
	CAMN A,UNAMS(B)
	SKIPA A,NAMS(B)
	AOBJN B,.-2
	SIXSP UUOA
SNARF3:	SIXOUT [SIXBIT /, TODAY IS @/]
	SKIPGE TIME
	JRST SNARF
	MOVE A,DATE
	LSH A,30
	SIXSP UUOA
	LDB A,[220100,,DATE]
	LDB B,[140400,,DATE]
	IMULI A,12
	ADD A,B
	SIXSP MONTHS-1(A)
	MOVEI A,'-_6
	DPB A,[141400,,DATE]
	SIXSP DATE
	.RYEAR B,
	LDB B,[320300,,B]
	CAIE B,6
	JUMPN B,NOHAS
	LSH B,-2
	SIXOUT [SIXBIT /HUH? @/]
	SIXSP SUNSAT(B)
	SIXSP [SIXBIT /DAY?/]
NOHAS:	.SUSET [.TTY,,A]
	DPB A,[140300,,TXX]
	LSH A,-3
	DPB A,[220300,,TXX]
NOHAT:	SIXIN TXX
	MOVE C,B
	CAIN B,5
	SIXOUT [SIXBIT / (PRESUME TTY)@/]
	MOVSI B,-19
OLOOP:	SKIPL D,LINEL(C)
	JRST NOHAT
	.IOTI 3212
	TLNN B,3
	SIXOUT [SIXBIT /EVERY 4TH LINE IS SHORT-@/]
ILOOP:	TRZ D,100
	TRNE B,1
	DPB D,[240100,,.+1]
	.IOTI 40(D\0)
	AOBJN D,ILOOP
	.LISTE A,
	JUMPE A,HADNUF
	.IOT 1,A
	CAIN A,7
	JRST DUN
	SIXOUT [SIXBIT /-^G TO LOGOUT, ^Z$G TO RESTART@/]
HADNUF:	AOBJN B,OLOOP
DUN:	.VALUE [ASCII /U/]
TXX:	SIXBIT /-T00 TAG # @/
UUOH:
LOC 41
	PUSHJ P,UUOH
LOC UUOH
	MOVEM A,UUOA
	LDB A,[331100,,40]
	CAILE A,UUOMAX
	JRST 4,40
	XCT UUOTAB(A)
	JRST DECIN

UUOTAB:	JRST 4,40	;0
	JRST AIOTI	;.IOTI
	PUSHJ P,ASIXIO	;SIXIN
	JRST ASIXIO	;SIXOUT
	JRST ASIXSP	;SIXSP
UUOMAX=.-UUOTAB

AIOTI:	PUSH P,[470700,,40]
	HRLZS 40
	ILDB A,(P)
	JUMPE A,.-1
	.IOT 2,A
	ILDB A,(P)
	JUMPN A,.-2
POPUJ:	POP P,A
UUOEX:	MOVE A,UUOA
	POPJ P,

ASIXSP:	MOVEI A,440600
	HRLM A,40
ASIXSQ:	ILDB A,40
	JUMPE A,UUOEX
	CAIE A,'-
	ADDI A,40
	.IOT 2,A
	JRST ASIXSQ

ASIXIO:	MOVEI A,440600
	HRLM A,40
ASIXIP:	ILDB A,40
	CAIN A,'@
	POPJ P,
	CAIE A,'-	;=CR
	ADDI A,40
	.IOT 2,A
	JRST ASIXIP

5SEC:	PUSH P,[12]
	MOVEI A,17
	.SLEEP A,
	.LISTE A,
	JUMPE A,.+3
	.IOT 1,UUOA
	AOSA -1(P)
	SOSE (P)
	JUMPE A,5SEC+1
	JRST POPUJ

SNARF:	MOVE B,[360600,,CHBUF]
SNARF1:	PUSHJ P,5SEC
	SIXOUT [SIXBIT /(TYPE DATE) @/]
	CAIN A,177
	JRST SNARF2
	TRC A,40
	IDPB A,B
	CAIN A,15#40
	JRST NOHAS
	JRST SNARF1
SNARF2:	CAMN A,[360600,,CHBUF]
	JRST SNARF3
	MOVEI A,'@
	DPB A,B
	SIXOUT CHBUF
	ADD B,[060000,,]
	JUMPGE B,SNARF1
	SUB B,[360000,,1]
	JRST SNARF1

DECIN:	MOVEI B,0
DECIN1:	PUSHJ P,5SEC
	POPJ P,
	CAIN A,40
	JRST DECIN1
	CAIG A,40
	POPJ P,
	IMULI B,10.
	ADDI B,-"0(A)
	CAIE A,177
	JRST DECIN1
1JPOP:	SOS (P)
	POPJ P,

UUOA:	0
LINEL:	0	;MUST BE 0
	0
	0
	0
	0
	-87.,,1
	-87.,,1	;6
	-87.,,1
	-71.,,1
	-87.,,1
	0
CHBUF:	SIXBIT /-/
	BLOCK 9
SUNSAT:	SIXBIT /SUN/
	SIXBIT /SATUR/
GRTAB:	IRPS A,,MORNING AFTERNOON EVENING GRIEF DAY
	[SIXBIT /A @/]
TERMIN
MONTHS:	IRPS A,,JAN FEB MAR APR MAY JUN JUL AUG SEP OCT NOV DEC
	SIXBIT /A/
TERMIN
UNAMS:	IRPS A,,TC CW GW RN R RWA ES MJG MB MS H DS PH JET PG JBR RG DEE FW NS
SIXBIT /A/
TERMIN
NAMS:	IRPS A,,TOM CARL GEORGE RUSS RICH BOB GENE MIKE MIKE MIKE H.HACK SLIVER PETER JAIME PHIL JEFF BLATT BEAST FRED NAGEL
SIXBIT /A/
TERMIN
NNAMS==.-NAMS
PDL:	BLOCK 6
END GO
ð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒð0`Áƒ