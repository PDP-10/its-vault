t:tan(the)$
tp:the+delthe$
tm:the-delthe$
tanp:tan(tp)$
tanm:tan(tm)$
tand:tan(delthe)$
tandh:tan(delthe/2)$
f:r*(tanp-tanm-2*tan(delthe)*tanp*tanm)/(tanp+tanm)$
g:r*(t - tanm-2*tan(delthe/2)*t*tanm)/(t+tanm)$
h:r*(tanp-t-2*tan(delthe/2)*tanp*t)/(t+tanp)$
m:matrix([a11,a12,a13,a14,a15,a16],
         [a21,a22,a23,a24,a25,a26],
         [a31,a32,a33,a34,a35,a36],
         [a41,a42,a43,a44,a45,a46],
         [a51,a52,a53,a54,a55,a56],
         [a61,a62,a63,a64,a65,a66])$

l1:[a11=f,a21=g,a31=h,a41=f,a51=g,a61=h]$
l2:[a12=f*tanm,a22=g*tanm,a32=h*t,a42=f*tanp,a52=g*t,a62=h*tanp]$
l3:[a13=f*tanm^2,a23=g*tanm^2,a33=h*t^2,a43=f*tanp^2,a53=g*t^2,a63=h*tanp^2]$
l4:[a14=tand,a24=tandh,a34=tandh,a44=tand,a54=tandh,a64=tandh]$
l5:[a15=tand*tanm,a25=tandh*tanm,a35=tandh*t,a45=tand*tanp,a55=tandh*t,a65=tandh*tanp]$
l6:[a16=tand*tanm^2,a26=tandh*tanm^2,a36=tandh*t^2,a46=tand*tanp^2,a56=tandh*t^2,a66=tandh*tanp^2]$

ll:[2*r*(tanp-tanm),2*r*(t-tanm),2*r*(tanp-t),2*r*(tanp-tanm),2*r*(t-tanm),2*r*(tanp-t)]$


(m1:[a11,a21,a31,a41,a51,a61],m2:[a12,a22,a32,a42,a52,a62],m3:[a13,a23,a33,a43,a53,a63],m4:[a14,a24,a34,a44,a54,a64],m5:[a15,a25,a35,a45,a55,a65],m6:[a16,a26,a36,a46,a56,a66])$

b1:taylor(ev(de,map("=",m1,ll),l2,l3,l4,l5,l6)/ev(de,l1,l2,l3,l4,l5,l6),delthe,0,7)$

STORE([AM,DONE,DSK,MANUAL],B1)$
