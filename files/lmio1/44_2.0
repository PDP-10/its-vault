FS:
(DEFSELECT (HOST-TOPS20 HOST-ITS)
  (:LOGIN-UNIT (UNIT LOGIN-P &AUX (CONN (HOST-UNIT-CONTROL-CONNECTION UNIT)))
    (AND CONN (EQ (CHAOS:STATE CONN) 'CHAOS:OPEN-STATE)
	 (IF (NOT LOGIN-P)
	     (CHAOS:CLOSE CONN "Logging out")
	     (LET ((PKT (CHAOS:GET-PKT))
		   (NEW-USER-ID)
		   (PASSWORD)
		   (ID (FILE-MAKE-TRANSACTION-ID)))
	       (MULTIPLE-VALUE (NEW-USER-ID PASSWORD)
			       (FILE-GET-TOPS20-PASSWORD USER-ID (HOST-UNIT-HOST UNIT)))
	       ;; LOGIN <UID> <PASS> <NULL ACCOUNT STRING>
	       (CHAOS:SET-PKT-STRING PKT ID "  LOGIN " NEW-USER-ID " " PASSWORD "  ")
	       (CHAOS:SEND-PKT CONN PKT)
	       (SETQ PKT (FILE-WAIT-FOR-TRANSACTION ID CONN "Login"))
	       (LET ((STR (CHAOS:PKT-STRING PKT))
		     IDX)
		 (SETQ STR (NSUBSTRING STR (1+ (STRING-SEARCH-CHAR #\SP STR))))
		 (SETQ IDX (FILE-CHECK-COMMAND "Login" STR))
		 (LET ((HSNAME NEW-USER-ID)
			HSNAME-STRING ITEM)
		   (SETQ HSNAME-STRING (STRING-APPEND "PS:<" (STRING-UPCASE HSNAME) ">"))
		   (FILE-HOST-LOGGED-IN (HOST-UNIT-HOST UNIT) HSNAME-STRING)
		   (IF (SETQ ITEM (ASSOC (HOST-UNIT-HOST UNIT) USER-HSNAMES))
		       (RPLACD ITEM HSNAME-STRING)
		       (PUSH (CONS (HOST-UNIT-HOST UNIT) HSNAME-STRING) USER-HSNAMES)))
		 ;; Only do the following kludge if the guy's home isn't ITS
		 (COND ((NULL USER-PERSONAL-NAME)
			(SETQ USER-PERSONAL-NAME USER-ID)
			(SETQ USER-GROUP-AFFILIATION #/W)
			(SETQ USER-PERSONAL-NAME-FIRST-NAME-FIRST NEW-USER-ID)))))))
    T)
  (:INIT-HOST-UNIT (UNIT HOST-NAME)
		   (SETF (HOST-UNIT-HOST UNIT) HOST-NAME)
		   (SETF (HOST-UNIT-MAX-DATA-CONNECTIONS UNIT) 8.)) )

SI:
(DEFMETHOD (PROCESS :PRINT-SELF) (STREAM &REST IGNORE)
  (FORMAT STREAM "#<~A ~A ~O>" (TYPEP SELF) NAME (%POINTER SELF)))