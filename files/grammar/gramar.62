



(PDEFINE CLAUSE
	 (POSITION-OF-PRT MVB LOCATIONMARKER SUBJ-VB-BACKUP-TYPE1 POSITION-OF-PTW)

;;;
;;;
;;;
;;;
	 
	 ;;;
;;     THE CLAUSE PROGRAM IS DIVIDED ALONG CONCEPTUAL LINES INTO TWO MAJOR
;;SECTIONS AND FINER DIVIDIONS WITHIN THEM.  ALL CONCEPTUAL DEVIDING LINES
;;ARE SET OFF BY LARGE OUTLINED COMMENTS OR BY BLOCKS OF OPEN SPACE.
;;THE TWO MAJOR SECTIONS ARE INVOLVED IN PARSING MAJOR AND SECONDARY
;;CLAUSES RESPECTIVELY. THE MAJOR CLAUSE IS CONSIDERABLY LARGER,
;;SINCE MUCH OF THE CODE FOR SECONDARY CLAUSES INVOLVES IDENTICAL
;;ACTIONS AS THE MAJOR ONES AND HAS CONSEQUENTLY BEEN MERGED TOGETHER.
;;;
;;     FOLLOWING THE MAJOR BOUNDARIES OUTLINED BY THE GRAMMAR,
;;THE CODE IS DIVIDED INTO FINE SECTIONS WHICH REFLECT THE MAJOR
;;CHOISES OF FEATURES AND WHICH ARE MADE AS SOON AS POSSIBLE IN THE
;;COURSE OF A PARSING. THE MAJOR DIVISIONS RUN ROUGHLY AS FOLLOWS:
;;;
;;;
;;;  MAJOR CLAUSES
;;;        INITIAL MODIFIERS
;;;        <DECISION ON TYPE OF CLAUSE>
;;;           DECLARATIVE
;;;               -PARSE A SUBJECT
;;;               -PARSE A VERB GROUP FOR THE MAIN VERB
;;;               <LOOK AT THE MVB(MAIN VERB) AND DECIDE IF SPECIAL PROCESSING IS IN ORDER>
;;;                 (ACTIVE) -PARSE ANY OBJECTS THAT IT REQUIRES
;;;                    -VERB-PARTICLE CONSTRUCTIONS
;;;                    TRANS2
;;;                    TRANS1
;;;                    TRANSL (REQUIRES A LOCATION IE. "PUT")
;;;                    -RESOLVE ANY COMPLICATIONS
;;;                   <CALL SEMANTICS TO PROCESS WHAT IS FOUND SO FAR>
;;;                   -PARSE ANY FOLLOWING CONSTRUCTS -PREPG'S, ADJUNCT CLAUSES, BOUND CLAUSES, ETC.
;;;                   <JUMP TO THE END>
 
;;;                 (BE)
;;;                 (PASSIVE)
;;;                 (THERE)   "THERE IS A PIGEON ON YOUR SHOULDER"
;;;             IMPERATIVES
;;;                 -RATHER SHORT SINCE MOST OF ITS CODE WOULD DUPLICATE THE DECL'S
;;;             QUESTIONS
;;;
;;;   SECONDARY CLAUSES
;;;         BOUND-CLAUSES
;;;         RANK-SHIFTED-QUALIFIERS
;;;         TO-CLAUSES
;;;         SUBTO-CLAUSES
;;;         ING-CLAUSES
;;;         REPORT-CLAUSES
;;;   RETURN TO THE PROCEDURE WHICH REQUESTED THE PARSING
;;;
;;;
;;;
;;;
;;     PLEASE NOTE THAT THE TAGS(LABELS) "RETURN" AND "FAIL", WHICH ARE
;;OFTEN REFERED TO, ARE NOT EXPLICITLY LOCATED ANYWHERE IN THE CODE,
;;BUT ARE RATHER GENERAL FEATURES OF THE PROGRAMMAR LANGUAGE AND ARE
;;DEALT WITH BY THE PRE-PROCESSER WHICH EXAMINES ALL PROGRAMMAR PROGRAMS
;;BEFORE THEY ARE EXECUTED THE FIRST TIME AND DOES THINGS LIKE EXPANDING
;;THE "(: (BOOLEAN EXP.) TAG1 TAG2 TAG3)" FORMS AND ADDING THE TAGS
;; "RETURN" AND "FAIL".
;;;

;;;
;;;
ENTERING-CLAUSE
(SETR 'TIME (BUILD TSSNODE= (MAKESYM 'TSS))  C);EACH CLAUSE HAS A TIME ASSOCIATED WITH IT
;WHICH , AT A MINIMUM, REFLECTS CERTAIN
;INFORMATION ABOUT ITS VERB. THE REGISTER
;IS SET HERE REATHER THAN LATER SO THAT CLAUSE MODIFIERS,
;PARSED BEFORE THE MAIN VERB, WILL HAVE SOMEWHERE TO
;PLACE THEIR TIME RELATED INFORMATION
;;;
;;;
;;;
;;;
;;;



	 (: (CQ SIMP) SUBJ NIL);AN INITIAL DISPATCH TABLE WHICH EXAMINES THE INITIAL FEATURES
;OF THE CALL TO "(PARSE CLAUSE ...) AND DECIDES WHICH SECTION OF 
;CODE SHOULD BE JUMPED TO

	 (: (CQ MAJOR) INIT SEC);SIMPLE CLAUSES CONTAIN NO INITIAL
;MODIFIERS, SO PROCESSING STARTS AT "SUBJ"





	 ;;;
	 ;;;

;;;*************************************************************************************************
;;;                      
;;;                                               MAJOR CLAUSES
;;;
;;;*************************************************************************************************
;;;          MAJOR CLAUSES EXPECT TO FIND A SUBJECT, VERB GROUP, AND OBJECTS, AS DETERMINES
;;;          PRIMERALLY BY THE TRANSITIVITY OF THE MAIN VERB.


;;;
;;;
;;;
;;;






	 ;;;--------------------------------------------------
	 ;; INITIAL MODIFIERS
	 ;;;--------------------------------------------------
	 ;;;
	 INIT
	 (SETQ LOCATIONMARKER N)				       ;SEE THE LARGE COMMENT BELOW
	 (: (AND (NQ BINDER) (PARSE CLAUSE BOUND INIT))
	    NIL
	    MAJOR
	    FIXIT)
	 (FQ BIND)
	 (: (CALLSM (SMBIND))INIT NIL)
	 FIXIT
(SETQ PTW CUT)
(:(CUT (** PW)) INIT MAJOR)





	 
;;;
;;;------------------------------ MAKE SOME DECISIONS AS TO CLAUSE TYPE ---------
	 MAJOR
	 (CUT END);RESET THE CUT POINT WHICH MAY HAVE 
;BEEN MOVED BY EARLIER OPERATIONS
	 (: (CQ REPORT) FDEC NIL)
	 (COND ((EQ PUNCT '?) (GO QUEST))			       ;QUESTIONS ARE PRESENTLY ONLY NOTICED BY THEIR
	       ((OR (CQ IMPER) (EQ PUNCT '!)) (GO IMPER)))	       ;PUNCTUATION THIS WILL BE IMPROVED FAIRLY SOON
	 (GO THEREINIT)
	 FDEC
	 (FQ DECLAR)
;;;






	 ;;;
	 THEREINIT    ;CONSTRUCTIONS USING THE FUNCTION WORD "THERE" ARE CHECKED
;FOR EXPLICITLY AND PROCESSED BY A SPECIAL BLOCK OF CODE (SEE ABOVE)

	 (: (AND (NEXTWORD ' THERE) (PARSE NIL THERE) (FQ DECLAR))
	    THERE
	    NIL
	    (INIT))
;;;







	 THER2   ;MORE INITIAL (BEFORE THE SUBJECT) MODIFIERS
	 (AND (NQ PREP) (PARSE PREPG INIT)(OR(CALLSM(SMRELATE H))(POP)))
	 (AND (NQ ADV) (PARSE ADV TIMW)(OR(CALLSM(SMADVERB))(POP)))
	 (AND (NQ ADV) (PARSE ADV TIM2)(OR(CALLSM(SMADVERB))(POP)))
	 (AND (NQ ADV) (PARSE ADJG ADV VBAD)(OR(CALLSM(SMRELATE H))(POP)))
	 (PARSE NG TIME)
	 
	 ;;;
	 (: (EQ LOCATIONMARKER N) CLAUSETYPE THEREINIT INPOP)
	 
	 ;; THE VARIABLE "LOCATIONMARKER" MARKS THE POSITION OF PTW
	 ;;AT THE TIME THAT IT WAS SET.  IF IT HAS NOT MOVED (IS
	 ;;STILL EQUAL TO N) THAN THAT INDICATES THAT NOTHING HAS
	 ;;BEEN PARSED AND WE CAN GO ON, OTHERWISE, THERE CAN BE ANY
	 ;;NUMBER OF INITIAL MODIFIERS AND THE CODE STARTING AT
	 ;;"INIT" IS REPEATED, AS MANY TIMES AS NECESSARY.  IF PTW
	 ;;HITS THE CUT POINT, THAN IT IS ASSUMED THAT SOMETHING WAS
	 ;;MISTAKENLY PARSED AS A MODIFIER WHEN IT WAS NOT, AND
	 ;;EVERYTHING IS POPPED OFF (BY THE "INPOP" CODE)
	 INPOP
	 (: (* C DLC) NIL (INPOP))				       ;DOES ANYTHING REMAIN ON THE TREE?
	 BICUT
	 (CUT-BACK-ONE)  ;"CUT-BACK-ONE" IS THE NORMAL BACKINGUP MECHANISM
;FOR THE GRAMMAR, IT SETS PTW (POINTER TO THE WORD) BACK ONE
;FROM WHERE IT WAS AND SETS "CUT" TO PTW. THE FOLLOWING GOTO
;TELLS WHICH BLOCK OF CODE IS TO BE REPEATED.
						       
	 (GO INIT)						       
	 





	 ;;;
;;;------------ RE-EXAMINE THE CLAUSETYPE, PARTICULARLY TO CHECK FOR VERB-INITIAL IMPERATIVES
	 ;;;
	 CLAUSETYPE						       
	 (: (CQ DECLAR) SUBJ NIL)
	 (: (AND (NQ VB)  (PARSE VG IMPER) (FQ IMPER)) VG1 NIL);SEE THE NOTE UNDER IMPERATIVES BELOW

	 (FQ DECLAR)
	 (: (CQ IMPER) (IMPER) NIL)
;;;

















	 ;;;
;;;**********************************************************************
;;;                  TRY TO PARSE A GRAMMATICLY ACCEPTABLE SUBJECT.
;;;
;;;  ONCE THAT IS DONE, SET THE SUBJECT REGISTER (FOR USE BY SEMANTIC ROUTINES AND OTHER PARTS OF THE GRAMMAR)
;;;  AND MOVE ONE TO THE CODE FOR WHICH LOOKS FOR THE MAIN VERB (MVB) -"VG"
;;;**********************************************************************
	 ;;;
	 SUBJ
	 (CUT END)						       ;RESET CUTPOINT INCASE IT WAS MODIFIED BY
;PREVIOUS BACKUPS
	 SUBJ3;IF THE FIRST WORD INDICATES THE POSSIBILITY
;OF A RANK-SHIFTED CLAUSE SERVING AS THE SUBJECT, THEN TRY
;TO PARSE ONE AS SUCH
	 (: (OR (AND (NEXTWORD ' TO) (PARSE CLAUSE RSNG TO SUBJ))	       ;FEATURE "SUBJ" INSURES A CHECK THAT ANY
		(AND (NQ ING) (PARSE CLAUSE RSNG ING SUBJ))	       ;PRONOUNS FOUND ARE IN SUBJECTIVE CASE.
)
	    SUBREG
	    NIL
	    SUBJ1)
	 
	 ;;;
	 ;;;
	 SUBJ4
	 (: (PARSE NG SUBJ) SUBREG NIL SUBJ1)			       ;IF PARSING THE SUBJ CAUSES THE CUT POINT TO BE
;REACHED, THEN JUMP TO "SUBJ1" TO SEE IF WE ARE
;IN CONDITIONS WHERE THAT IS ALLOWED
	 




	 ;;;
	 ;;;
	 (COND ;WHAT TO DO IF THE SUBJECT CANNOT
;BE DIRECTLY PARSED

((ISQ (GETR 'QUESTION-ELEMENT C) QADJ) ;THIS IS CHECKING
;FOR THE SITUATION WHERE A QUESTION WORD IS ACTING
;AS LOGICAL SUBJECT AND HAS ALREADY BEEN PARSED AS
;IN "WHAT IS IN THE BOX?"
 (SETR 'SUBJECT (GETR 'QUESTION-ELEMENT C) C)
 (GO VB))


((CQ REL-NOT-FOUND)  ;THE CLAUSE WILL HAVE THIS FEATURE IF IT
;IS ACTIVE AS A RSQ AND ITS MISSING ELEMENT HAS NOT YET
;BEEN DETERMINED.  SINCE WE CANNOT FIND ANY SUBJECT, WE
;ASSUME THAT IT IS A SUBJECT-RELATIVE IN THIS CASE.
 (RQ REL-NOT-FOUND)
(SETR 'SUBJECT(GETR 'RELHEAD C)C)
 (GO VB))

			       
								       
(SUBJ-VB-BACKUP-TYPE1 (SETQ SUBJ-VB-BACKUP-TYPE1  NIL) (GO SUBJ11))  ;SEE THE LARGE NOTE ABOUT THIS IN "NOVERB".
			       
								       
	       ((AND H (ISQ H TIME)) (GO HEAD));WHAT WAS INITIALLY PARSED AS A TIME-NG MODIFING THE WHOLE CLAUSE
;MAY PROBABLY BEEN THE SUBJECT OF THE CLAUSE
			       
								       
	       ((* C U (REL-NOT-FOUND));THIS WORRIES ABOUT RELATIVE
;CLAUSES. PLEASE NOTE THAT THE CURRENT HALF-VERSION HAS NOT YET
;GOT ITS HEAD TOGETHER ABOUT RELATIVE CLAUSES. -IE. THE CODE
;ISN'T DEBUGGED AND HAS GAPS IN IT ESP. WHO SETS WHAT REGISTER WHEN
;THIS WILL BE FIXED BEFORE THE VERSION IS FINALIZED
					       
		(FQ UPREL SUBUPREL)
		(SETR 'SUBJECT (GETR 'RELHEAD PT) C)
(SETR 'RELHEAD(GETR 'RELHEAD PT)C)
(REMOVE-F-PT 'REL-NOT-FOUND PT)
		(GO VB))
					       
	       ((AND (CQ COMPONENT) NN) (FQ SUBJFORK) (GO VB));"SARAH ATE DINNER AND WENT TO THE MOVIES."

	       
	       	       (H (POP) (GO SUBJ))				       ;POP OFF THE CLOSEST INITIAL MODIFIER AND TRY TO
	       ((GO FAIL)))					       ;PARSE A SUBJ AGAIN
;;;




	 ;;;
	 HEAD
	 (: (OR (** N PW (NOUN)) (** N PW (PRON))) NIL HEAD)   ;MOVE PTW TO THE CLOSEST NOUN
;THEN SET THE CUT POINT TO IT AND ATTEMPT A NEW PARSING
	 SUB2
	 (POP)
	 (: (CUT PTW) INIT SUB2)
	 



;;;
	 SUBJ1        ;CIRCUMSTANCES UNDER WHICH IT IS ALLRIGHT
;TO HAVE NOTHING FOLLOWING THE SUBJECT OF THE CLAUSE

	 (COND ((ISQ H QUOTED)   ;"  "MUMBLE", SAID JOHN."
                              (AND (ISQ H LIST) (FQ LIST))
			       (FQ QUOTED)
			       (SETQ H (H H))
			       (GO RETSM)))			       
	 (AND        ;THIS IS PART OF A BACKUP MECHANISM
;WHICH NEEDS TO BE MORE THROUGHLY THOUGHT OUT.
;THE SITUATION IS EXPLAINED IN DETAIL IN QUESTION.NGQST
              (CQ REL-NOT-FOUND)
	      (* H PV (QAUX))					       ;MOVE PT TO A VERB WHICH CAN BE AN AUXILLIARY
	      (COND ((ISQ PT BE)				       ;AND WHICH CAN BEGIN A CLAUSE
		     (FQ INT AUXBE)
		     (RQ REL-NOT-FOUND)
		     (SETR 'COMP (GETR 'RELHEAD C) C)
(SETR 'SUBJECT H C);"WHAT COLOR IS THE BLOCK?" OR "HOW BIG IS THE BLOCK?"
(SETMVB PT)
		     (GO ONT))
		    ((ISQ PT HAVE)
		     (FQ SUBQ)
		     (RQ REL-NOT-FOUND)
		     (SETR 'SUBJECT (GETR 'RELHEAD C) C)
		     (GO VBL))))
	 
	 ;;;
	 SUBJ11
	 (: (CUT-BACK-ONE) SUBJ3 (SUBJ11))   ;IF WE CAN'T CUT BACK ANY FURTHER,
;THEN FAIL




	 
	 
	 SUBREG
	 (SETR 'SUBJECT H C)     ;THIS SETS THE "SUBJECT" REGISTER OF THE CURRENT
;CURRENT NODE TO WHATEVER IS POINTED TO BY "H" (IN THIS CASE
;THAT WOULD BE THE MOST RECENTLY PARSED DAUGHTER OF THE CURRENT NODE)

	 (GO VB)						       





	 ;;;

;;;*******************************************************************
;;;                          PARSE A VERB GROUP
;;;
;;;   ONCE THE VERB GROUP IS PARSED, THE TRANSITIVITY OF THE MAIN VERBIS EXAMINED - CAUSEING THE
;;;   APPROPRIATE SECTIONS OF THE CODE BELOW TO BE EXECUTED AND TO ATTEMPT TO PARSE THE REQUIRED OBJECTS
;;;      ONCE ALL THE OBJECTS HAVE BEEN PARSED, THE PROGRAM JUMPS TO THE TAG "ONT", WHERE A SEMANTICS PROGRAM
;;;   IS CALLED TO MAKE SENCE OUT OF EVERYTHING
;;;******************************************************************
	 ;;;
	 VB
	 (: (PARSE ADJG ADV VBAD) VB NIL (VB-ADJG))		       ;PARSE ANY INITIAL MODIFIERS
	 
	 	 (RQ VBLOK)   ;?????



	 ;;;
	 VBL
	 (: (PARSE VG) VBREG NIL)   ;ONCE THE VERB GROUP IS PARSED, SET THE REGISTER



  ;;;
	 NOVERB     ;WHAT TO DO IF THE VG CANNOT BE DIRECTLY PARSED

	 (COND ((CQ REL-NOT-FOUND)         ;"WHICH BLOCK IS RED?"

		(RQ REL-NOT-FOUND)
		(SETR 'SUBJECT (GETR 'RELHEAD C) C)
		(POP QAUX)
		(GO VBL))
	       ((CQ SUBJFORK)
		(FQ VBFORK)
		(COND ((ISQ (* PC) TRANS2) (FQ TRANS2) (GO OB2X))
		      ((ISQ PT TRANSL) (FQ TRANSL) (GO TRANSL1))
		      ((ERT CLAUSE VBL:VBFORK) (GO FAIL))))	       ;THIS POINT SHOULD NEVER BE REACHED
	       ((ISQ H QUOTED) (FQ REL-NOT-FOUND) (GO SUBJ4))
	       ((NOT (ISQ H SUBJ)) (ERT CLAUSE VBL: H SUBJ) (GO FAIL))
	       ((ISQ H CLAUSE) (SETQ SUBJ-VB-BACKUP-TYPE1 T) (POP) (GO SUBJ4))     ;THIS IS EXACTLY WHAT IS LOOKS LIKE. IE.
;AN ARBITRARY, NOT TOO WELL THOUGHTOUT BACKUP MECHANISM.
;(NEEDLESS TO SAY IT WILL GO AWAY FAST)  WE HAVE BEEN UNABLE
;TO FIND A VERB AND HAVE NOTICED THAT WE PARSED A CLAUSE OF SOME
;SORT AS THE SUBJECT. HYPOTHESIS: WE MISSINTERPRETED SOMETHING WHILE
;PARSEING THAT CLAUSE AND MANAGED TO SWALLOW UP THE VERB OF THE
;HIGHER CLAUSE WITH IT. SOLUTION: POP OFF THE CLAUSE AND TRY TO 
;REPARSE THE SEGMENT IN ANOTHER FASHION. "SUBJ4" IS PLACED THE THE
;SUBJECT CODE AFTER LOOKING FOR CLAUSES AND BEFORE NOUN GROUPS.

	       ((ISQ H SUBJ) (POP) (FQ SUBJFORK) (GO VBL)))
	 VB2
	 (CUT-BACK-ONE)						       ;DEFAULT CUTTING MECHANISM FOR VBL
	 (GO SUBJ3)
	 
	 ;;;
	 VBREG
	 (SETR 'VG H C)
	 






;;;*******************************************************************
;;;
;;;                                   PARSE ANY OBJECTS REQUIRED BY THE VERB
;;;
;;;*******************************************************************
	 ;;;
	 VG1
	 (CUT END)    ;RESET THE CUTPOINT IN CASE ANYONE CHANGED IT





;;;
	 (: (ISQ MVB BE) BE NIL (BE))				       ;JUMP TO "BE" PROCESSOR
	 (: (ISQ H PASV) PASV NIL PNPRT)			       ;JUMP TO PASSIVE CODE
	 (FQ ACTV)						       ;NOT PASV=ACTIVE



;;;
	 (: (AND (ISQ MVB QUOTING)				       ;AN ACTIVE QUOTING VERB
		 (ISQ (GETR 'SUBJECT C) QUOTED)			       ;WITH A QUOTED SUBJECT IS FOLLOWED BY THE REAL
		 (PARSE NG SUBJ)				       ;SUBJECT
		 (SETR 'SUBJECT H C)
		 (FQ REL-NOT-FOUND))
	    QTRNS
	    NIL)
	 



	 ;;;
	 ;;;--------------------------------------------------   VERB-PARTICLE COMBINATIONS 
;;;
;;;     - SUCH AS "PUT ON", "SET DOWN", ETC. -   THEIR ESSENTIAL PROPERTY IS THAT VERB AND PARTICLE
;;;     CAN BE DISPLACED BY THE OBJECT.
;;;        "PUT DOWN THE BLOCK."
;;;        "PUT THE BLOCK DOWN."
;;;
;;;
	 ;;;
	 (: (ISQ MVB VPRT) NIL NPRT NPRT)			       
	 (: (AND (NQ PRT) (PARSE PRT)) NIL DPRT)		       ;IF THE PARTICLE IS NOT THE WORD FOLLOWING THE VERB
;THEN IT IS SEARCHED FOR BY CODE AT "DPRT" (DISPLACED PARTICLE)


;;;
	 (: (SETMVB   (COMBINATION? (WORD (NB MVB)) (WORD (NB H))))    ;IS THIS A LEGITIMATE COMBINATION OF VERB
;AND PARTICLE ?
	    NIL
	    NPRT)
	 (FQ PRT)
	 (: (ISQ MVB TRANS) TRANSP NIL TRANSPQ)   ;IN MUCH OF THE CODE THAT FOLLOWS, THIS WILL
;BE A COMMON PATTERN. THE THIRD TAG IN A PROGRAMMAR FORM IS JUMPED
;TO WHEN THE BOOLEAN IS TRUE AND THERE ARE NO MORE WORDS LEFT.
;IN THIS CASE, THAT MIGHT SIGNAL A CONSTRUCTION SUCH AS
;"WHAT DID YOU PUT IT IN?"   - SIMILAR QUESTION CONSTRUCTIONS
;ARE POSSIBLE FOR ALL OBJECTS.

	 IPRT
	 (: (ISQ MVB ITRNS) NIL POPRT)   ;NO OTHER CHOISES OF TRANISITIVITY WOULD BE GRAMATICAL
;SO POPRT CAN POP OFF THE PARTICLE SO THAT IT COULD BE
;REPARSED AS SOMETHING ELSE
	 (FQ PRT ITRNS)
	 (GO ONT)
	 



	 ;;;
	 DPRT							       ;SEARCH FOR DISPLACED PARTICLE
	 (: (SETQ POSITION-OF-PRT (** N NW (PRT))) NIL NPRT)	       ;IF NOT FOUND ASSUME THAT IT IS OPTIONAL
;AND WE ARE DEALING WITH THE CASE
;WITHOUT THE PARTICLE
	 (: (SETMVB (COMBINATION? (WORD (NB MVB))
				    (WORD POSITION-OF-PRT)))
	    NIL
	    NPRT)
	 (: (ISQ MVB TRANS) NIL NPRT)
	 (CUT POSITION-OF-PRT)
	 (:  (PARSE NG OBJ OBJ1) ;PARSE UP ANY NOUN GROUP YOU FIND
	    POPRT
	    NPRT						       ;IF THERE ARE MORE OR LESS NP'S THAN
;EXPECTED, THEN DON'T PARSE ANYTHING BUT
;GO TO NPRT INSTEAD.
	    NIL)      ;SIMILARLY, IF ANYTHING FOLLOWS THE DISPLACED PARTICLE
;THEN A GRAMMATICALLY BAD FORM IS ASSUMED AND THE PIECES POPED OFF
						       
	 (CUT END)						       
(SETR 'OBJ1 H C)
	 (PARSE PRT)						       
	 (FQ PRT DPRT TRANS)
	 (GO ONT)
;;;





	 ;;;
	 ;;---- PARSE OBJECT OF MVB AND GO TO "ONT"
	 TRANSP							       ;THIS BLOCK OF CODE IS A FAIRLY
;STANDARD SET OF REQUESTS TO PARSE WHICH TRY TO COME UP WITH AN
;ACCEPTABLE NOUN GROUP TO SERVE AS AN OBJECT. IT WILL BE REPEATED
;AT SEVERAL POINTS BELOW.   THE ARGUMENTS TO "PARSEREL" ALL DESCRIBE
;VERIETIES OF RANK-SHIFTED NOUN-GROUP CLAUSES
;AND THE SPECIAL NOTATION IS MERELY A PROGRAMMING CONVENIENCE

	 (: (PARSEREL '((INGOB ING) (TOOB TO)
				    (SUBTOB SUBTO)
				    (REPOB REPORT))
		      '(OBJ OBJ1)
		      MVB)
	    OBB
	    NIL)
	 (: (PARSE NG OBJ OBJ1) OBB NIL)				       
;;;





;;;
TRANSPQ
	 (COND
	       ((* C U (REL-NOT-FOUND))
		(SETR 'OBJ1 (GETR 'RELHEAD PT) C)
      (REMOVE-F-PT 'REL-NOT-FOUND PT)
		(GO FQPRT))
	       ((GO IPRT)))					       ;IPRT CHECKS FOR POSSIBLE ITRNS
;;;





;;;
	 OBB
	 (SETR 'OBJ1 H C)
	 FQPRT
	 (FQ PRT TRANS)
	 (GO ONT)
	 


	 ;;;
	 POPRT
	 (POPTO VG)
	 







	 ;;;
	 NPRT     ;RESET THE CUT POINT BEFORE CHECKING FOR TRANS2
	 (CUT END)
	 
	 ;;;--------------------------------------------------  TRANS2
;;;
;;;   THIS IS FOR VERBS WHICH TAKE TWO OBJECTS SUCH AS "GIVE". OBJ1 AND OBJ2 ARE DETERMINED
;;;   STRICTLY BY POSITION - ANY OTHER SORTING OUT BY DIRECT/INDIRECT/WHATHAVEYOU OBJECT, IS
;;;   HANDLED BY THE SEMANTICS ROUTINES

	 ;;;
	 (: (ISQ MVB TRANS2) NIL TRANS TRANS)   ;IF NOT TRANS2 THEN JUMP TO TRANS



;;;
	 OB2X
	 (: (AND  (PARSE NG OBJ OBJ1)			       ;PARSE 1ST OBJECT
		     
		 (CUT END))
	    NIL
	    OBJ1Q   ;MAYBE THE FIRST OBJECT HAS BEEN QUESTIONED
;OR IS IN A HIGHER OR LOWER CLAUSE.
	    OBJ2Q) ;SAME IDEA AS TRANSPQ ABOVE - PERHAPS THE 2D OBJECT IS
;BEING QUESTIONED AS IN "WHAT DID YOU GIVE HIM?"




	 (SETR 'OBJ1 H C)   ;ASSUMING THAT THE FIRST OBJECT WAS SUCESSFULLY PARSED
;WE SET THE REGISTER , RESET THE CUTPOINT (AS A PRECAUTION)
;AND GO AFTER THE SECOND ONE

	 (CUT END)
	 OBJ2
	 (: (PARSEREL '((INGOB2 ING) (TOOB2 TO)			       ;PARSE THE SECOND OBJECT
				     (SUBTOB2 SUBTO)
				     (REPOB2 REPORT)
				     )
		      '(OBJ OBJ2)
		      MVB)
	    TRANS2
	    NIL)
	 (: (PARSE NG OBJ OBJ2) TRANS2 NIL)
;;;




;;;
	 OBJ2Q
(COND
((* C U (REL-NOT-FOUND))
 (SETR 'OBJ2 (GETR 'RELHEAD PT) C) (REMOVE-F-PT 'REL-NOT-FOUND PT)(FQ TRANS2)(GO ONT)))

(COND (NN)  ;FOR THIS TO BE TRANS2
;THERE MUST BE MORE WORDS IN THE CLAUSE
 ((CUT-BACK-ONE) (GO OB2X))
 ((ERT CLAUSE OBJ2Q BUG)))




;;;
(: (COND ((AND (NEXTWORD ' TO) (ISQ MVB TO2) (PARSE PREPG TO)) ;THE SECOND-OBJECT
;THAT WE HAVE BEEN LOOKING FOR MAY BE A PREPG AS IN
;"GIVE IT TO THE LIONS"
        )
(SETR 'OBJ2 (GETR 'OBJ1 H)C);TAKES THE OBJECT OF THE PREPOSITION
;"TO" AND MAKES IT THE OBJ2 OF THE CLAUSE.
   (FQ TRANS2TO TRANS2))
  ((AND (CQ PREPQ) (* H PV (QUEST)) (EQ (WORD (** FW) 'TO))
   (RQ PREPQ)
   (FQ TRANS2TOQ TRANS2)(SETR 'OBJ2 (GETR 'OBJ1 PT)C))) ;"TO WHOM DID YOU GIVE THE MEAT?"

ONT
POTR)



;;;
TRANS2
(SETR 'OBJ2 H C)
(FQ TRANS2)
(GO ONT)

;;;
OBJ1Q
(CUT END)
(COND
 ((* C U (REL-NOT-FOUND))
  (SETR 'OBJ1 (GETR 'RELHEAD PT) C)
(REMOVE-F-PT 'REL-NOT-FOUND PT)
(GO OBJ2)  ))
(GO TRANS)








	 ;;;
	 POTR    ;CONSIDER EVERYTHING THAT WAS PARSED AFTER THE VERB
;AS BAD AND POP THEM OFF BEFORE TRYING "TRANS"

(BUG CLAUSE  - IF WE GET TO THIS POINT WE/'RE SCREWED AS FAR AS BACKUP
IS CONCERNED SINCE WE/'VE BEEN THROWING INFORMATION AWAY)
	 (RQ REL-NOT-FOUND)
	 (RQ OBJ1Q OBJ1REL)
	 (POPTO VG)
;;;




	 
	 ;;;-------------------------------------------------- TRANS1 AND TRANSL
;;;
;;;   TRANS(ITIVE) VERBS TAKE ONE OBJECT "JOHN IS EATING AN APPLE" WHILE TRANSL
;;;   (TRANSITIVE-LOCATION) TAKE ONE NORMAL OBJECT AND ONE OBJECT WHICH MUST BE A LOCATION
;;;
	 TRANS
	 (: (ISQ MVB TRANSL) TRANSL1 NIL NIL)
	 (: (ISQ MVB TRANS) NIL ITRNS QTRNS)
	 



;;;
	 TRANS1							       ;WHEN A SUITABLE OBJ IS FOUND GOTO TR TO PICKUP
	 (: (PARSEREL '((INGOB ING) (TOOB TO)			       ;POSSIBLE MODIFYING ADVS
;ENGLISH ALLOWS NO MODIFIERS BETWEEN VERB AND OBJECT
				    (SUBTOB SUBTO)
				    (REPOB REPORT)
				    )
		      '(OBJ OBJ1)
		      MVB)
	    TR
	    NIL)
	 (: (PARSE NG OBJ OBJ1) TR QTRNS)
;;;




	 ;;;
	 TRANSL1
	 (: (PARSE NG OBJ OBJ1 NOLOC) TR NIL)
;;;




	 ;;;
	 QTRNS
	 (COND
	       ((* C U (REL-NOT-FOUND)) (SETR 'OBJ1 (GETR 'RELHEAD PT) C)
(REMOVE-F-PT 'REL-NOT-FOUND PT)
			  (GO TR2)))
	       (GO ITRNS)
;;;





	 ;;;
	 TR     ;SET THE REGISTER "OBJ1" TO THE CONSTITUENT JUST PARSED
	 (SETR 'OBJ1 H C)
	 TR2
	 (CUT END)
	 (AND NN (NQ ADV) (PARSE ADV VBAD))			       ;A LOCATION WITHIN A CLAUSE WHERE
;ADVERBS MAY APPEAR FREELY





	 
	 ;;;-------------------------------------------------- TRANSL
	 ;;;
(: (AND(ISQ MVB TRANSL)(FQ TRANSL))LOCT NIL TRSLQ)
(FQ TRANS)(GO ONT)

;;;




	 
	 ;;;
	 LOCT      ;SYNTACTIC CANDIDATES FOR A EXPRESSING
;A LOCATION
	 (COND ((OR (AND (NQ PREP) (PARSE PREPG PLACE LOBJ))
		    (AND (NQ ADV) (PARSE ADV PLACE (LOBJ))))
                (SETR 'LOBJ H C)
		(GO ONT)))
;;;



;;;
	 TRSLQ
	 (COND
((AND(* C U (QADJ))(ISQ(GETR 'QADJ PT)PLACE))
(SETR 'LOBJ PT C)
(SETR 'RELHEAD (GETR 'QADJ PT)PT)
(SETR 'QADJ NIL PT)
(REMOVE-F-PT 'QADJ PT)(GO ONT)));THIS HANDLES THINGS
;LIKE "WHERE DID YOU SAY YOU WERE GOING TO PUT THE STASH?" IN WHICH
;"WHERE IS INITIALLY INTERPRETED AS A QADJ, BUT TURNS OUTî;TO BE A RELATIVE OBJ2 OF THE EMBEDDED CLAUSE.  IT WILL
;MISS THE OBSCURE CASE OF "THE PLACE I SAID I WAS GOING TO PUT IT"
;BUT WILL GET "ON WHAT DID YOU SAY...."





;;;--------------------------------------------------- RECONSIDER THE TRANSITIVITY OF THE VERB
	 ;;;
	 ;;;
	 (: (OR (AND (CQ TRANSL);BECAUSE WE HAVE REACHED THIS PIECE
;OF CODE WE KNOW THAT WE WERE UNABLE TO PARSE A LOCATION-OBJECT
;AND THEREFORE MUST REVISE THE DECISION ON TRANSITIVITY ACCORDINGLY
;IF THE VERB IS NOT MARKED (IN THE LEXICON) AS EITHER TRANS/TRANSL
;OR ITRNSL/INRNS THEN THIS LAST CHANCE FAILS AND
;WE PASS THROUGH TO SEVERAL COMPLEX CHOPPING MECHANISMS
;BELOW
				       
		     (ISQ MVB TRANS)				       
		     (RQ TRANSL)				       
		     (FQ TRANS))				       
		(AND (CQ ITRNSL)
		     (ISQ MVB ITRNS)
		     (RQ ITRNSL)
		     (FQ ITRNS)))
	    ONT
	    NIL)
	 
	 ;;;
	 LTRAN							       ;POP OFF THE PREP IF IT CAN BE FOUND THEN RESET
	 (: (* C DLC PV (NG) DLC (PREPG)) NIL CHOP)		       ;CUT AND JUMP TO TRANS1
	 (** FW)
	 PLWRD
	 (POP)
	 (: (CUT PTW) TRANS1 PLWRD)
	 (POPTO VG)
	 
	 ;;;
	 ;;;
	 CHOP
	 (: (ISQ H COMPOUND) NIL CHOPLOSE)
	 (SETQ H (CONS (CAR (* H DF)) (CDR H)))
	 (SETQ NN (EQ CUT (SETQ N (N PT))))
	 (GO RETSM)



;;;
	 CHOPLOSE
	 (ERT CLAUSE -- CHOPLOSE -- BACKUP ISN/'T GOOD ENOUGH TO FIND CONSTITUENTS)
	 (GO FAIL)
	 
	 ;;;
	 ;;;
	 ;;; --------------- INTRNS ---------------
	 ITRNS
	 (: (ISQ MVB INT) INT1 NIL NIL)
	 INTT
	 (: (ISQ MVB ITRNSL) NIL INTTT)
	 (:(FQ ITRNSL)LOCT LOCT TRSLQ)
	 INTTT
	 (AND (ISQ MVB ITRNS) (FQ ITRNS) (GO ONT))
	 
	 ;;;
	 ;;;
	 ;;;
	 VBLOK
	 (COND ((MEET FE '(QUEST REL)) (ERT VBLOK) (GO FAIL)))	       ;VERB DOESNT WORK
	 (: (AND MVB (SETQ PTW (NB MVB)))
	    NIL
	    (VBLOK))						       ;LOOK FOR DIFFERENT VERB
	 (OR (POP SUBJ) (AND (ERT BLOK) (GO FAIL)))
	 (: (CUT PTW) NIL (ITRNS))
	 (FQ VBLOK)
	 (GO SUBJ3)						       ;REPARSE THE SUBJ WITH THIS NEW CUT POINT
	 










;;;***************************************************************************************************
;;;
;;;                               INITIAL SEMANTIC PROCESSING
;;;
;;;*****************************************************************************************************
	 ONT
(: (CALLSM (SMCL1)) NIL (SMCL1))





;;;
	 (: (NOT (CQ REL-NOT-FOUND)) TONT NIL RETSM)  ;IF THE FEATURE "REL-NOT-FOUND" IS PRESENT
;AT THIS POINT, IT INDICATES THAT WE ARE IN A RELATIVE
;CLAUSE AND MAY HAVE TO DO SOME GYMNASTICS IF THE
;CLAUSE IS NOT TO FAIL

	 
	 (: (ISQ (GETR 'HEAD (GETR 'RELHEAD C)) TIM1) NIL PREPSHORT)
;MOVE BACK TO A QUESTION-NOUNGROUP, THEN
;DOWN AND BACK TO THE NOUN. IF THAT NOUN IS "TIM1"
;THEN ASSUME WE HAVE FOUND OUR RELATIVE ELEMENT.

TIMEQ
(RQ REL-NOT-FOUND) (FQ TIMEQ) (GO TONT)


;;;
PREPSHORT
(:(AND (NQ PREP) (PARSE PREPG)) NIL (ONT-SHORT-PREP))
	 (: (CALLSM (SMRELATE H)) NIL (ONT: SMRELATE PREPQ))
(:(CQ REL-NOT-FOUND) PREPSHORT TONT (ONT-NOT-FOUND))
	 
	 ; WE HAVE A PREP TO TAKE THE UNATTACHED RELATIVE AS ITS
	 ;OBJECT. THE FEATURE REL-NOT-FOUND WILL BE REMOVED IF THE
;PREPG DISCOVERS IT CAN'T FIND AN OBJECT (THE REMOVING WILL BE
;DONE WHILE IN PREPG).




;;;************************************************************************************
;;;                    CHECK FOR ADDITIONAL MODIFYING PHRASES
;;;************************************************************************************
	 TONT
	 (: (SETQ POSITION-OF-PTW N) NIL RETSM RETSM)   ;WE ARE USING THE SAME TECHNIQUE HERE
;AS WITH THE INITIAL MODIFIERS. IE. LOOP THROUGH THE POSSIBILITIES
;UNTILL YOU MAKE A PASS THAT ADDS NOTHING NEW.




;;;************************************* PREPG
	 NPASV
	 (: (AND (NQ PREP)
		 (PARSE PREPG)
		 (CALLSM (SMRELATE H)))
	    NIL
	    NIL
	    RETSM)

	 





;;;********************************** TIMW
	 (: (AND (NQ TIMW) (PARSE ADV TIMW) (OR (CALLSM (SMTIME))
						(GO FAIL)))
	    NIL
	    NIL
	    RETSM)
	 





;;;****"******************************* TIM2
	 (: (AND (NQ TIM2) (PARSE ADV TIM2) (OR (CALLSM (SMTIME2))
						(GO FAIL)))
	    NIL
	    NIL
	    RETSM)
	 





;;;************************************* ADV
	 (: (AND (NOT (CQ BE)) (PARSE ADJG ADV) (OR (CALLSM (SMRELATE H))
						    (GO FAIL)))
	    NIL
	    NIL
	    RETSM)
	 





;;;************************************** TIME NOUN GROUP
	 (: (AND (PARSE NG TIME) (OR (CALLSM (SMTIME)) (GO FAIL)))
	    NIL
	    NIL
	    RETSM)
	 





;;;************************************* PLACE
	 (: (AND (NQ PLACE) (PARSE ADV PLACE) (OR (CALLSM (SMPLACE))
						  (GO FAIL)))
	    NIL
	    NIL
	    RETSM)
	 





;;;************************************ BINDER
	 (: (AND (NQ BINDER)
		 (PARSE CLAUSE BOUND)
		 (OR (CALLSM (SMBIND)) (GO FAIL)))
	    NIL
	    NIL
	    RETSM)
	 





;;;************************************** TO CLAUSE (ADJUNCT)
	 (: (AND (NEXTWORD ' TO)
		 (PARSE CLAUSE TO ADJUNCT)
		 (OR (CALLSM (SMTOADJ)) (GO FAIL)))
	    NIL
	    NIL
	    RETSM)
	 







;;;
 (:  (EQ N POSITION-OF-PTW) NIL TONT RETSM)
		       ;LOOP UNTILL NOTHING ELSE CAN BE PARSED
(: (OR(NOT(CQ TOPLEVEL))(NQ SPECIAL)) RETSM NIL)
		       ;SPECIAL WORD (E.G. COMMA AND) COULD INDICATE A
;CONJUNCTION OR A BINDER

	 (ERT CLAUSE: SOMETHING LEFT OVER AT TOP LEVEL)
	 (GO FAIL)
	 









;;;*********************************************************************************************************************
;;;
;;;                          SPECIAL PROCEDURES FOR THE VERB    "BE"
;;;
;;;*********************************************************************************************************************
	 BE
	 (FQ BE)
(:(AND(PARSE NIL NOT)(FQ NEG))NIL NIL POPBE)
	 (: (OR (CQ COMPQ) (CQ MEASQ)) BENT NIL)
	 (: (AND (NQ TIMW) (PARSE ADV TIMW)) NIL NIL POPBE)	       ;IF EVERYTHING LOOKED LIKE A MODIFIER, POP OFF
	 (: (AND (NQ TIM2) (PARSE ADV TIM2)) BEP BEP NIL)	       ;THE LAST THING PARSED. THIS WOULD HAPPEN IN "WHAT DAY WAS YESTERDAY?"

	 POPBE
	 (POP)
	 



;;;
	 BEP      ;PARSE A COMPLEMENT OF SOME SORT

	 (: (AND (NQ PREP) (PARSE PREPG COMP)) INT NIL)
	 INT1
	 (: (PARSE ADJG COMP) BENT NIL INT)
	 (: (PARSE NG COMP) INT NIL)
	 (: (CQ BE) NIL INTT)      ; TO HANDLE INTENSIVES OTHER THAN BE, LIKE "MAKE"
;WHICH CAN TAKE A COMPLEMENT IN "HE MADE ME SICK" BUT DON'T HAVE
;TO HAVE ONE.

	 (: (ISQ H VG) CHOP NIL)
	 (POP);WE'VE BEEN CONFUSED BY SOMETHING WHICH LOOKED LIKE A MODIFYING PHRASE
;AS IN ???

	 (GO BEP)
	 



;;;
	 BENT      ;CHECK FOR THE POSSIBILITY THAT THE SUBJECT WAS A 
;DUMMY 
; FUNCTION WORD ( "IT" ), AS IN "IT WAS NICE TO SEE HIM."

	 (: (EQ (WORD (NB (GETR 'SUBJECT C))) 'IT)
	    NIL
	    INT)
	 (: (OR (AND (NEXTWORD ' TO) (PARSE CLAUSE RSNG TO SUBJ))
		(AND (NQ ING) (PARSE CLAUSE RSNG ING SUBJ))
		(PARSE CLAUSE REPORT))
	    NIL
	    INT)
	 (FQ IT)
(SETR 'LOGICAL-SUBJECT H C);THE CLAUSE IS THE REAL SUBJECT.

(* C)  ;RESET THE POSITION OF PT


;;;
	 INT
	 (SETR 'COMP H C)
	 (FQ INT)
	 (GO ONT)
;;;







;;;***********************************************************************************************
;;;
;;;                                     PASSIVES
;;;
;;;***********************************************************************************************
	 PASV
	 (FQ PASV)
	 (: (AND NN
		 (NQ PRT)    ;NEXT WORD CAN BE A PARTICLE

		 (ISQ (SETQ PT MVB) VPRT)   ;CAN THE MVB TAKE A PARTICLE?

		 (SETMVB (COMBINATON? (WORD(NB MVB)) (WORD N))) ;WOULD IT MAKE SENSE FOR THESE TWO TO BE
;A COMBINATION ? -IF SO, COMBINE THEM

		 (ISQ MVB TRANS))
	    NIL
	    PNPRT)
	 (PARSE PRT)
	 (FQ PRT TRANS)
	 (GO PONT)
	 
	 ;;;
	 ;;THIS PIECE OF CODE IS CALLED FROM VG1 WHEN PASSIVE VERB NOTED BUT NO ROOM IS LEFT
	 ;;IN THE SENTENCE  FOR THE OBJS
	 PNPRT							       ;WHEN MVB IS PASSIVE BUT NOT PARTICLED
	 (FQ PASV)						       ;TRANSFER TO NORMAL SECTIONS OF CODE IF THE
	 (: (ISQ MVB TRANS2) OBJ2 NIL)				       ;TRANSITIVITY IS OTHER THAN OBJ1
	 (: (ISQ MVB TRANSL) TR NIL)
	 (: (ISQ MVB TRANS) NIL PASBLOK)
(FQ TRANS)
(GO PONT)

					       ;IF ANYTHING LEFT, LOOK FOR A "BY" PHRASE
	 


	 ;;;
	 PASBLOK
(CUT-BACK-ONE)
	 (GO VBL)     ;CUT BACK AND REPARSE THE VERB

	 


;;;******************************** "BY" PHRASES
	 PONT
	 (AND (NEXTWORD ' BY) (PARSE PREPG AGENT) (FQ AGENT))
(SETR 'LOGICAL-SUBJECT (GETR 'OBJ1 H) C) ;"LOGICAL" IE. SUBJECT IN RELATIONSHIP TO THE
;PROPER SEMANTIC INTERPRETATION OF THE MAIN VERB.
(SETR 'OBJ1 (GETR 'SUBJECT C) C)
(:(AND(CQ RSQ)(NOT(CQ AGENT)))FAIL ONT)
	 (GO ONT)   ;GO TO "ONT" REGARDLESS OF WHETHER OR NOT A
;AGENT-PREPG CAN BE PARSED (REFLECTS THE OPTIONALITY
;OF THE CONSTRUCTION)

	 









;;;**************************************************************************************** 
;;;                                   THERE
;;;
;;;             AS IN:  "THERE IS A BIRD SITTING ON YOUR SHOULDER"
;;;
;;;****************************************************************************************
	 THERE
	 (FQ THERE)
	 (CUT END)
	 (: (OR (PARSE ADV TIMW) (PARSE ADV TIM2)) NIL NIL (THERE)); "THERE IS A BIRD.."

	 (: (PARSE VG BE ) THEF NOTHE (THERE))
	 
	 ;;;
	 THERQ
	 (: (ISQ (* H PV (QAUX)) BE) THEF NIL)			       ;IF THIS FAILS, THE THERE IS CONSIDERED TO BE
	 (FQ POLR2)						       ;REFERING TO A PLACE AND IS PARSED AS SUCH
	 (: (AND (NQ TIMW) (PARSE ADV TIMW)) NIL NIL (THEREQ))
	 (: (AND (NQ TIM2) (PARSE ADV TIM2)) NIL NIL (THEREQ)); "WHEN HAS THERE BEEN A BIRD ON YOUR SHOULDER?"
	 (: (PARSE VG BE) THEF NIL)
	 (RQ POLR2)
	 (GO NOTHE)
	 
	 ;;;
	 THEF
	 (: (AND (NQ ADV) (PARSE ADV TIMW)) NIL NIL (THEF))
	 (: (AND (NQ ADV) (PARSE ADV TIM2)) NIL NIL (THEF));"IS THERE A BIRD...?"
	 (: (PARSE NG SUBJ SUBJT) NIL THERQ)
(SETR 'SUBJECT H C)
	 (GO ONT)
	 
	 ;;;
THERQ
(: (* C U (REL-NOT-FOUND))NIL NOTHE)
(SETR 'SUBJECT (GETR 'RELHEAD PT)C)
(REMOVE-F-PT 'REL-NOT-FOUND PT)
(GO ONT)
	 NOTHE
	 (RQ THERE)
	 (POP THERE)
	 (AND (NQ ADV) (PARSE ADV PLACE))
	 (GO THER2)
	 







;;;************************************************************************************************
;;;
;;;                                       IMPERATIVES
;;;
;;;************************************************************************************************
	 ;;;
	 IMPER
	 (: (PARSE NG TIME) NIL NIL IMPOP)			       ;MODIFIERS WHICH MAY PRECEED THE VERB
	 (: (AND (NQ ADV) (PARSE ADJG ADV VBAD)) NIL NIL IMPOP)
	 (: (AND (NQ ADV) (PARSE ADV TIMW)) NIL NIL IMPOP)
	 
	 ;;;
	 IMPE
	 (: (PARSE VG IMPER) NIL IMPOP)
	 (FQ IMPER)
	 (GO VG1)
	 
	 ;;;
	 IMPOP
	 (: (POP NIL) IMPE (IMPOP))
	 










;;;***************************************************************************************
;;;
;;;                                                 QUESTIONS
;;;
;;;***************************************************************************************
	 QUEST
	 (FQ QUEST)
	 

;;;***************************** PREP QUESTION
	 (: (NQ PREP) NIL NGQUES)
	 (: (PARSE PREPG) NIL NGQUES (PREPQ-INCOMPLETE));"ON WHICH BLOCK DID YOU PUT IT?"
(: (ISQ H QUEST) NIL QUEST);IF THE PREPG ISN'T THE QUESTION, TRY AGAIN
;"ON THAT DAY, WHERE DID YOU GO?" -- MAYBE WE COULD MAKE USE
;OF THE COMMA CLUE.
(SETR 'QADJ H C);PREPQ IS HANDLED MUCH LIKE QADJS LIKE WHEN AND WHERE
(GO POLAR);THE REST OF THE QUESTION HAS THE SAME SYNTAX
;AS A POLAR (YES-NO).

	 


;;;***************************** NOUN GROUP QUESTION
	 NGQUES
	 (: (PARSE NG QUEST) NGQST NIL);"WHICH ONE IS THE MURDURER?"

	 (: (OR (AND (NEXTWORD ' HOW) (PARSE ADJG QUEST) (SETR 'RELHEAD H C));"HOW BIG...."

		(AND (NQ QADJ) (PARSE QADJ) (FQ QADJ)(SETR 'QADJ H C)));"WHAT...?",  "WHERE...?"

         POLAR POLAR 	    NIL)


	 (FQ SHORTQUES)
(CALLSM(SMADJQSHORT))
  ;IF ALL THE SENTENCE CONSISTS OF IS THE QUESTION ADJECTIVE
;THEN WE SHOULD RETURN DIRECTLY
ADJQS
	 (GO RETURN)						       



	 
	 ;;;
	 NGQST
(SETR 'RELHEAD H C)
NGQST2
	 (CUT END)

(SETR 'SUBJECT H C)
	 (AND (NQ ADV) (PARSE ADJG ADV VBAD))
 ;;WE HAVE HERE A VERY INTERESTING SITUATION INVOLVING A
;;TEMPORARY AMBIGUITY IN THE INTERPRETATION OF CERTAIN VERB
;;WHICH IS ELIMINATED WHEN MORE CONSTITUENTS OF THE CLAUSE HAVE
;;BEEN PARSED. CONSIDER SENTENCES LIKE:
;;;        WHICH BOX CONTAINS A RED BLOCK?
;;;        WHICH HAND HAS THE M&M'S?
;;;        WHICH HAND HAS HE BEEN HAVING TROUBLE WITH?
;;A THIS POINT IN THE CLAUSE PROGRAM WE HAVE PARSED THE FIRST NG
;;AND ARE ABOUT TO PARSE THE VERB GROUP. IN THE FIRST SENTENCE
;;WE WILL NEVER HAVE ANY PROBLEM BECAUSE THE VERB IS MARKED
;;WITH THE FEATURE "NAUX" MEANING THAT IT CAN NEVER SERVE A
;;AN AUXILLIARY TO ANOTHER VERB. HOWEVER IS THE VERB WE SEE
;;AT THIS POINT IN THE PARSEING IS A FORM OF "HAVE" OR "BE" WE
;;CANNOT YET DETERMINE WHETHER IT IS IN A CONSTRUCTION SUCH AS
;;THE SECOND OR THE THIRD SENTENCE. - IS IT THE MAIN VERB OF
;;THE CLAUSE OR ONLY AN AUX TO A VERB WHICH WE HAVEN'T PARSED
;;YET???  WHAT WE DO IT MAKE A TENTATIVE DECISION ONE WAY
;;OR THE OTHER AND THEN MAKE ARRANGEMENTS TO CHANGE THINGS
;;LATER IF WE FIND WE WERE WRONG. ONCE WE HAVE PARSED THE NEXT
;;NOUN GROUP WE CAN MAKE THE FINAL DECISION.
;;OUR TENTATIVE CHOICE IS TO CALL THE VERB WE JUST PARSED
;;THE MAIN VERB OF THE SENTENCE. THEN WE KNOW THAT IF
;;ANOTHER VERB FOLLOWS THE NEXT NG WHEN WE SHOULDN'T EXPECT
;;ONE THAT WE HAVE MADE THE WRONG CHOICE AND SHOULD REARRANGE
;;OUR ANALYSIS
(COND((PARSE VG NAUX) (FQ SUBJQ) (GO VG1))   

	       ((PARSE VB AUX (QAUX)) (CALLSM (SMVAUX))
				      
                                     (SETMVB H)
                                   (SETR 'QAUX H C)
				      (FQ POLR2 REL-NOT-FOUND))
	       (T (** N PW) (POP NG QUEST) (CUT PTW) (GO NGQUES)))  ;POP BACK AND
;START FIGURING OUT THE QUESTION ALL OVER AGAIN

QUEST2
	 (: (AND (NEXTWORD ' THERE) (PARSE NIL THERE)) THERE SUBF)   ;"ARE THERE....?"



;;;
	 SUBF
	 (: (PARSE NG SUBJ);PARSE THE SUBJECT OF ANYTHING LIKE:
;"DID THE WOMAN GET THE JOB?" IF SUCCESSFUL, CONTINUE AT "SUBREG" IN THE
;NORMAL PART OF THE CLAUSE PROGRAM (RESETTING THE SUBJECT REGISTER) 
;(THE BEGINNING OF THE VERB GROUP SECTION). "SUBJ1" WORRIES
;ABOUT WHAT SHOULD HAPPEN IF THE SUBJECT SEEMS TO FINISH
;THE SENTENCE

	    SUBREG
	    NIL
	    SUBJ1)

(RQ REL-NOT-FOUND)
(GO BE)

;;;************* POLAR
	 POLAR
	 (: (AND (NQ VB)
		 (PARSE VB AUX (QAUX))
                    (SETR 'QAUX H C)
                    (CALLSM (SMVAUX))
		 (SETMVB H))
	    NIL
	    QCHOP)
	 (OR (CQ QADJ)(GETR 'RELHEAD C) (FQ POLAR))
	 (FQ POLR2)

	 (GO QUEST2)
	 


	 ;;;
	 QCHOP
	 (ERT CLAUSE: QCHOP)
	 (: (POPTO CLAUSE BOUND) BICUT (QCHOP))
	 











;;;********************************************************************************************
;;;
;;;                                              SECONDARY CLAUSES
;;;
;;;********************************************************************************************
;;;
;;             SECONDARY CLAUSES ARE PRINCABLY THOSE THAT ARE NOT MAJOR. THIS INCLUDES ADJUNCTS, RANK-SHIFTED-NOUN-GROUP'S, 
;;          RANK-SHIFTED-QUALIFIERS, FOR-TO CLAUSES AND OTHERS.;;;             IF THE CLAUSE IS MARKED "RSQ", THEN IT AUTOMATICALLY WILL HAVE SEVERAL SPECIAL REGISTERS ASSOCIATED WITH IT TO FACILITATE
;;          SEMANTIC PROCESSING. 'RELWORD WILL POINT TO THE INITIAL RELATIVE PRONOUN IF THERE IS ONE (THAT, WHICH, WHO...). ALSO
;;          "REL-NOT-FOUND" IS A TEMPORARY FEATURE WHICH IS RELIVANT DURING THE PROCESSING OF A CLAUSE, IT INDICATES THAT THE ELEMENT OF
;;          THE CLAUSE WHICH WAS TAKEN OVER INTO THE RELATIVE WORD (SUBJ, OBJ1...) HAS NOT YET BEEN DETERMINED.
;;             'RELHEAD IS A REGISTER WHICH POINTS TO WHATEVER THE CLAUSE MODIFIES. IN THE CASE OF AN RSQ IT IS SET INITIALLY TO
;;          "(GETR 'HEAD (* U))" WHICH IS THE HEAD NOUN OF THE NP WITHIN WHICH THE RSQ IS BEING PROCESSED
;;;
;;;
;;;
	 ;;;
	 SEC
	 (COND ((CQ BOUND) (GO BOUND))				       ;CHECK INITIAL FEATURES AND JUMP ACCORDINGLY
	       ((CQ TO) (GO TO))
	       ((CQ RSQ) (GO RSQ))
	       ((CQ SUBTO) (GO SUBTO))
	       ((CQ REPORT) (GO REPORT))
	       ((CQ ING) (GO ING))
	       (T (MQ RSNG-TYPE) (GO FAIL)))
	 
	 ;;;
	 ;;;
	 ;;; --------------- BINDER  ---------------
	 BOUND
	 (: (PARSE BINDER) NIL (BOUND) (BINDER))
	 (GO FDEC)       ;"FDEC" IS NEAR THE TOP OF THE MAJOR CLAUSE

	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;; --------------- RSQ  ---------------
	 RSQ
(SETR 'RELHEAD (* C U (NG)) C)
	 (: (CQ PREPREL) NIL RSQ2)
	 (PARSE PREPG PRONREL)  ;THIS CALL IS BASED ON INFORMATION PASSED FROM FAR AWAY
;AND EXPLAINED IN DETAIL IN THE CODE FOR PREPOSITION GROUPS
(SETR 'QADJ H)
	 (GO REPORT)

;;;
	 RSQ2
(COND((PARSE VG EN PASV)   ;HAVING DETERMINED THAT THE VERB IS PASSIVE
;IF IT WERE NOT ALSO TRANSITIVE, THEN WE WOULDN'T KNOW
;WHAT TO DO WITH WHATEVER WAS PARSED AS A SUBJECT - SO
;WE FAIL

(OR (ISQ MVB TRANS)(GO FAIL))
          (SETR 'SUBJECT (GETR 'RELHEAD C) C)(GO PASV))

((PARSE VG ING)
         (SETR 'SUBJECT (GETR 'RELHEAD C) C)
		(GO VG1))
	       ((NQ PRONREL)(PARSE NG RELWD)(GO REL))   

	       ((PARSE NG SUBJ) (FQ REL-NOT-FOUND) (GO SUBREG))
(T(GO FAIL)));THIS REALLY ISN'T AN RSQ

	 
	 
;;;
	 REL
(SETR 'SUBJECT (GETR 'RELHEAD C )C)
	 (: (PARSE VG) VG1 NIL)
  ;OUR FIRST HYPOTHESIS, THAT THE SUBJECT WAS THE RELWORD,
;WAS JUST PROVEN WRONG SINCE WE CANNOT PARSE THE VG NEXT.
;SO WE REVISE OUR FEATURES AND JUMP TO PARSE A REAL FULL SUBJECT
;AS IN "...WHICH MARY THOUGHT WAS CHAUVANISTIC" AS OPPOSED TO
;"...WHICH WAS CHAUVANISTIC"

	 (FQ REL-NOT-FOUND)
	 (GO SUBJ)

	 ;;; --------------- TO  ---------------
 TO
	 (: (AND (CQ COMPONENT) (PARSE VG TO TODEL)) VG1 NIL);"I WANTED TO DANCE AND SING"

	 (: (NEXTWORD ' FOR) NIL TO1)				       ;THIS IS EXPERIMENTAL
	 (PARSE NIL FOR)					       ;PLEASE CHECK OUT ANY FOR-CLAUSES YOU CAN THINK
	 (FQ FOR)						       ;OF
	 (PARSE NG SUBJ TOSUBJ)
(SETR 'SUBJECT H C)
	 TO1
	 (: (PARSE VG TO) VG1 (TO))
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;; --------------- SUBTO  ---------------
	 SUBTO
	 (COND ((AND (CQ COMPONENT) (PARSE VG TO TODEL)) (SETR 'SUBJECT
(GETR 'SUBJECT (* PC))C)(FQ TODEL)
							 (GO VG1)));"...FOR JOHN TO RUN AND SING"

	 (: (AND (** N NW (EQ (WORD PTW) 'TO));FIND THE WORD "TO"
;AND PARSE THE SUBJECT BETWEEN WERE YOU ARE NOW
;AND THE "TO" - THEN RESET THE CUT POINT -PARSE A PROPERLY
;FORMER VG - TO -   , AND CONTINUE IN THE NORMAL FASHION

		 (CUT PTW)
		 (PARSE NG SUBJ SUBTO)
		 (SETR 'SUBJECT H C)
		 (OR (CUT END) T)
		 (PARSE VG TO))
	    VG1
	    (SUBTO))
	 





	 ;;; --------------- ING  ---------------
	 ING
	 (: (** N NW (ING)) NIL FAIL)
	 (: (OR (NQ ING) (AND (PARSE NG SUBJ INGSUB)
			      (SETR 'SUBJECT H C)
			      (FQ SUBING)
			      (RQ ING)))
	    NIL
	    NIL
	    (ING))
	 (: (PARSE VG ING) VG1 (ING))
	 





	 ;;; --------------- REPORT ---------------
	 REPORT
	 (AND (NEXTWORD ' THAT) (PARSE NIL THAT) (FQ THAT))
	 (GO FDEC)
	 




;;;******************************************************************
;;;                                RETURN
;;;***********************************************************************
	 RETSM
	 (OR (CALLSM (SMCL2)) (GO FAIL))
	 (GO RETURN))










(PDEFINE
 NG
 NIL
 
ENTERING-NG
 ;;;
 ;;;
 ;;;
 NGSTART							       ;EXAMINE INITIAL FEATURES AND JUMP TO
 (COND ((CQ RELWD) (GO RELWD))					       ;CORRESPONDING SPECIAL BLOCKS OF CODE
       ((CQ QUEST) (GO QUEST))
       ((OR (NQ QDET) (NQ QPRON)) (FQ QUEST) (GO QUEST))
       ((CQ TIME) (GO TIME))					       ;LOOK AT FIRST WORD
       ((NQ CLASF) (GO CLASF))
       ((NQ PROPN) (GO START))
       ((NQ TPRON) (GO TPRON))
((NQ EVERPRON)(GO EVERPRON))
       ((NQ PRON) (GO PRON)))
 
 ;;;
 ;;;
 ;;;
 ;;;
 LOOK								       ;THIS POINT MAY BE JUMPED BACK TO
 (COND ((NQ DET) (GO DET))
       ((NQ NUM) (GO NUM))
       ((OR (NQ ING) (NQ EN) (NQ ADJ)) (GO ADJ))
       ((NQ CLASF) (GO CLASF))
       ((NQ NUMD) (GO NUMD))
       ((NEXTWORD ' AT) (GO AT))
       ((NEXTWORD ' AS) (GO AS))
       ((NQ NOUN) (GO NOUN))
       ((NQ TIMORD) (GO TIMORD))
       ((AND(CQ COMPONENT)(ISQ (* PC)QUEST)) (GO QUEST))
       ((MQ START) (GO FAIL)))
 
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;--------------------------------------------------
 ;; IF YOU CAN PARSE ANY OF THESE SMALL THINGS, YOU'RE DONE
 ;;;--------------------------------------------------
 START								       ;PARSE A PROPER NOUN
 PROPN
 (PARSE PROPN)
(FQ DEF PROPNG)
 (: (ISQ H POSS) PROPS NIL)
 (: (AND NN (NQ PROPN)) PROPN NIL)
 PROPS								       ;EXAMINE ITS SEMANTICS
 (OR (CALLSM (SMPROP)) (GO FAIL))
 (: (ISQ H POSS) POSSX PRAG)
 
 ;;;
 ;;;
 ;;;--------------- PRONOUNS ---------------
 ;;;
 PRON
 (: (PARSE PRON POSS) POSSD NIL RED2)				       ;IS IT POSSESSIVE?
 PRON2
 (: (CQ NPRON) (NPRON) NIL)
 (: (OR (AND (CQ SUBJ) (PARSE PRON SUBJ))			       ;CHECK SUBJECTIVE OR OBJECTIVE
	(AND (OR (CQ OBJ) (CQ SUBTO)) (PARSE PRON OBJ)))	       ;CASE....
    NIL
    (PRON))
(FQ PRONG DEF)
PRON3
 (CALLSM(SMPRON H))			       ;EXAMINE SEMANTICS OF PN
 PRAG
(SETR 'HEAD H C)
 (* H)
 (TRNSF NS NPL NFS NEG)						       ;MODIFY PN FEATURES TO CORRECT
 (GO RETURN)							       ;NUMBER...
 
 ;;;
 ;;;
 ;;;---------------  ...ANYTHING, SOMETHING, ...  ---------------
 TPRON
 (PARSE TPRON)
 (FQ TPRON)
 (* H)
 (TRNSF NS NPL NEG)
(SETR 'HEAD C H)
 (AND NN (NQ ADJ) (PARSE ADJ))
 (GO SMNG)


;;;
;;; ----- WHATEVER, WHENEVER, WHEVER....
;;;
;;;
EVERPRON
(: (AND(PARSE PRON EVERPRON)(CALLSM(SMPRON H)))NIL FAIL)
(: (AND(PARSE CLAUSE RSQ NOREL)(CALLSM(SMRELATE H))) RETSM FAIL)
 
 ;;;
 ;;;
 ;;;
 ;;;--------------- AS ---------------
 AS
 (: (AND (PARSE NIL AS) (PARSE NUMD NUMDAS) NN (PARSE NIL AS))
    NUMD2
    (AS)
    (AS))
 
 ;;;
 ;;;
 ;;;--------------- AT + NUM ---------------
 AT
 (: (AND (PARSE NIL AT) (PARSE NUMD NUMDAT)) NIL (AT) (AT))
 NUMD2
 (: (AND (PARSE NUM) (FQ NUM NUMD)) DET1 (NUMD2) INCOM)
 
 ;;;
 ;;;--------------- OTHER NUMBER WORDS ---------------
 NUMD
 (: (PARSE NUMD NUMDAN) NIL ND3 INCOM)
 (: (PARSE NIL THAN) NIL INCOM POPCOM)
 (: (AND (PARSE NUM) (FQ NUM NUMD)) DET1 POPCOM INCOM)
 ND3
 (: (PARSE NUMD NUMDALONE) NUMD2 (NUMD) (NUMD))
 
 ;;;
 ;;;--------------- TIME WORDS ---------------
 TIME
 (: (AND (NQ TIME) (PARSE NOUN TIME)) RETSM NIL)
 (: (** N NW (TIM1)) LOOK (TIME))
 TIMORD
 (: (PARSE ORD TIMORD) NIL FAIL)
 (: (AND (PARSE NOUN TIM1) (FQ DET DEF) (CALLSM (SMNGTIME)))
    RETURN
    FAIL)
 
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;--------------------------------------------------
 ;; THE MAINSTREAM......  -MORE CMPLICATED NG TYPES
 ;;;--------------------------------------------------
 ;;;
 ;;;--------------- PARSE A DETERMINER ---------------
 DET
 (PARSE DET)
 (FQ DET)
 (* H)								       ;SHIFT PTR TO THE DETERMINER
 (: (TRNSF NPL NS PART DEF INDEF NEG QNTFR)IND (BUG) INCOM)
 
 ;;;
 ;;;
 ;;;--------------- INDETERMINATE ---------------
 IND
 (: (AND (EQ (WORD (NB H)) 'ALL)
	 (EQ (WORD N) 'THE)
	 (PARSE DET)
	 (FQ DEF))
    ORD
    NIL
    (THE))
 (: (AND (ISQ H QNTFR) (FQ QNTFR)) QNUM NIL)
 (: (CQ DEF) NIL ADJ)
 
 ;;;
 ;;;
 ;;;--------------- ORDINALS AND NUMBERS ---------------
 ORD
 (: (AND (PARSE ORD) (FQ ORD)) NIL NUM INCOM)
 (: (AND (NEXTWORD ' OF)						       ;TWELTH OF OCTOBER...
	 (ISQ (** N NW) MONTH)
	 (PARSE NIL OF)
	 (PARSE NOUN MONTH)
	 (FQ DATE))						       ;REMEMBER THAT FEATURES ARE DESIGNED AS AIDS TO
    RETSM							       ;SEMANTIC COMPREHENSION AS WELL AS SYNTACTIC
    NIL)							       ;PARSING.
 NUM
 (: (PARSE NUM) NIL ADJ)					       ;LARGE JUMP IF FALSE
 (FQ NUM)
 (: (CQ DET) NIL DET1)
 (: (COND ((AND (ISQ H NS) (CQ NS)) (RQ NPL PART))
	  ((CQ NPL) (RQ NS PART)))
    ADJ
    (NUM)
    INCOM)
 DET1
 (COND ((ISQ H NS) (FQ NS)) (T (FQ NPL)))			       ;EXPLICIT CHECK FOR THE VALUE 1
 (OR NN (AND (FQ NUMBER) (GO INCOM)))
 NUMBER
 (FQ DET)
 (: (NQ OF) OF ADJ)
 QNUM
 (: (ISQ H NONUM) OF NIL)
 (: (AND (PARSE NUM) (FQ NUM)) NIL OF)
 (: (COND ((EQ (SM H) 1.) (AND (CQ NS) (RQ NPL)))		       ;EXPLICIT CHECT FOR THE VALUE 1
	  ((CQ NPL) (RQ NS)))
    NIL
    (NUMD)
    INCOM)
 
 ;;;
 ;;;
 (: (EQ (WORD (NB H)) 'NO) ADJ NIL)				       ;CHECKS FOR WORD "NO"
 
 ;;;
 ;;;
 ;;;--------------- PREPG WITH "OF" ---------------
 OF								       ;"FIVE OF THE BLOCKS"
 (: (AND (NQ OF) (PARSE PREPG OF)) SMOF NONE)
 SMOF
 (FQ OF)
 (: (OR (CALLSM (SMNGOF)) (NOT (POP))) RETSM INCOM)
 
 ;;;
 ;;;
 NONE
 (: (EQ (WORD (NB H)) 'NONE) INCOM ADJ)
 
 ;;;
 ;;;
 ;;;
 ;;;-------------PARSE ALL THE ADJECTIVES ---------
 ADJ
 (: (PARSE ADJ) NIL CLASF EPR)
(AND (ISQ H COMPAR)(FQ COMPARATIVE-MODIFIER)
(SETR 'COMPARATIVE-MODIFIER H C))
(GO ADJ)
 EPR								       ;WE PARSED AN ADJ AND
 (: (OR (ISQ H SUP) (ISQ H COMPAR)) NIL REDUC)			       ;RAN OUT OF WORDS
 (FQ ADJ)
 (AND (NEXTWORD? 'OF)
      (PARSE PREPG OF)
      (OR (CALLSM (SMNGOF)) (GO FAIL))
      (FQ OF)
      (GO RETSM))
 (GO INCOM)
 
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;---------------PARSE ALL THE CLASIFIERS ---------------
 ;;;
 CLASF								       ;TRIES TO PARSE THE LARGEST POSSIBLE NG FIRST
 (: (OR (PARSE VB ING (CLASF)) (PARSE VB EN (CLASF)) (PARSE CLASF))
    CLASF
    NIL
    REDUC)
 
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;--------------- AND FINALLY...... THE NOUN ---------------
 NOUN
 (: (PARSE NOUN) NIL RED2)
 
 ;;;
 (: (AND (CQ TIME) (NOT (ISQ H TIM1))) RED1 NIL)
 
 ;;;
 ;;;--------------- MODIFY FEATURES FOR NUMBER AND SUCH ---------------
 (SETQ T1 FE)
 (COND ((AND (ISQ H MASS) (OR (CQ PART) (NOT (CQ DET)))) (FQ MASS)))
 (COND ((NOT (ISQ H NPL)) (RQ NPL PART)))
 (COND ((NOT (ISQ H NS)) (RQ NS)))
 (COND ((AND (NOT (CQ DET)) (NOT (CQ NUMD))) (* H) (TRNSF NPL MASS)))
 (: (MEET FE '(NS NPL PART MASS)) NIL RED0)
 

;;;*******************  "...A BIGGER BLOCK THAN...."
(: (NEXTWORD ' THAN) NIL SMNG)
(FQ THAN)   ;THE PRESENCE OF THIS FEATURE IS NOTED BELOW AND IN ADJG
;;;

 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;--------------------------------------------------
 ;; AT THIS POINT SMNG1 IS CALLED FOR PRELIMINARY CHECKS AND ANALYSIS
 ;;BEFORE CHECKING QUALIFIERS
 ;;;--------------------------------------------------
 SMNG
 
 ;;;
 (SETR 'HEAD H C)						       ;SET HEAD REGISTER TO THE NOUN
 
 ;;;
 ;;;
 (: (AND(CQ OBOFJ)(NOT(CQ DEF)))FAIL NIL)			       ;JUST PARSED
 (OR (CALLSM (SMNG1)) (GO FAIL))
 (: (NOT (ISQ H POSS)) NIL POSS RETSM)				       ;CHECK FOR POSSIVE
 
 ;;;
 ;;;--------------------------------------------------
 ;; POSSIBLE QUALIFIERS
 ;;;--------------------------------------------------
 ;;;
;;;
;;;
;;;
;;;***********"....A BIGGER BLOCK THAN..."
(: (AND(CQ THAN)(PARSE ADJG)) NIL RSQ-TO)
(: (CALLSM(SMRELATE H)) RETSM FAIL)
;;;



 ;;;
 ;;;--------------- RSQ TO ---------------
RSQ-TO
 (: (AND (NEXTWORD ' TO)
	 (MEET FE '(COMP SUBJ))
	 (PARSE CLAUSE RSQ TO)
	 (OR (CALLSM (RELATE H)) (GO POPRET)))
    RETSM
    NIL)
 
 ;;;
 ;;;
 ;;;--------------- AS OR COMPARATIVE ---------------
 (: (AND (OR (NEXTWORD ' AS) (NQ COMPAR))
	 (PARSE ADJG THANNEED)) NIL PREPNG)

						       ;WHAT IS THE REASON FOR THE EXISTANCE OF THIS
	     (AND (NULL N)					       ;STRANGE ANIMAL (ALSO THE ONEBELOW) -- CHECK
		  (CQ SUBJ)					       ;THEM OVER AND HACK THEM PROPERLY
		  (ISQ (* C PV) AUX)
		  (ISQ PT BE)
		  (GO POPRET));AVOIDS ATTACHING MODIFIER WHEN IT GOBBLES TO MUCH E.G.
;IS THE BLOCK ON THE TABLE? DOESN'T WNAT "THE BLOCK ON THE TABLE"
;AS A CONSTITUENT.
;I ADMIT ITS A HACK.
(: (CALLSM(SMRELATE H))RSQ-TO POPRET RETSM)
 
 ;;;
 ;;;
 ;;;--------------- ANY SORT OR PREPOSITION GROUP ---------------
 PREPNG
 (: (AND (NQ PREP)
	 (NOT (OR (AND (NQ PLACE) (CQ NOLOC))
		  (AND (CQ OBJ1) (ISQ MVB TRANSL) (NOT (ISQ (* C U)
							    QUEST)))))
	 (PARSE PREPG Q)) NIL DISGRSQ)
	     (AND (NULL N)
		  (CQ SUBJ)
		  (ISQ (* C PV) AUX)
		  (ISQ PT BE)
		  (NOT (ISQ (* U) NGQ))
		  (GO POPRET))
(: (CALLSM (SMRELATE H))RSQ-TO POPRET RETSM)
 
 ;;;
DISGRSQ ;;  CHECK FOR DISGUISED RSQ CLAUSES BY READING THE FAILURE MESSAGES
 ;;  SENT UP FROM PREPG. 
 (: (EQ (CAR MES) 'PREP-WHICH) NIL RSQ)
 (SETQ MES (CDR MES))
 (: (PARSE CLAUSE RSQ PREPREL) PREPNG (RSQ-PREPREL) RETSM)
 
 ;;;
 ;;;
 ;;;--------------- ANY OTHER RSQ ---------------
 ;;;
 RSQ
(: (AND (ISQ (* C U) POLR2)
		(CQ SUBJ)
		(NQ VB)
		(NOT (CQ SUBJT))
		(NOT (ISQ PT QADJ)))RETSM NIL)
(:     (PARSE CLAUSE RSQ)NIL RETSM)

(: (CALLSM(SMRELATE H))RETSM POPRET)
 
 ;;;
 ;;;--------------------------------------------------
 ;; THE ENTIRE NG SHOULD HAVE BEEN PROCESSED BY THIS POINT
 ;;;--------------------------------------------------
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;--------------------------------------------------
 ;; IF AT FIRST YOU DON'T SUCEED.......
 ;;;--------------------------------------------------
 RED0
 (SETQ FE T1)
 RED1
 (POP)
 RED2
 (COND ((NULL H) (MQ NO) (GO FAIL))
       ((ISQ H NUMBER) (GO INCOM))
       ((AND (ISQ H POSS)
	     (OR (ISQ H PRON) (AND (* H DLC) (ISQ PT PRON))))
	(POP)
	(GO PRON2))
       ((AND (NULL (CDR H)) (CQ DEFPOSS)) (GO POSSDEF))
       ((AND  (CQ QUEST) (NULL (CDR H))) (GO QDETCHECK))	       ;(CDR H) = T IF THERE IS ONLY ONE DAUGHTER TO
      ;THE CURRENT NODE
       ((ISQ H ADJ) (GO EPR))
       ((NOT (ISQ H CLASF)) (GO INCOM)))
 REDUC
 (POP)
 (: (AND (NULL H) (NQ PROPN)) PROPN NOUN)
 
 ;;;
 ;;;
 ;;;
 POPCOM
 (POP)
 
 ;;;
 ;;;--------------- INCOMPLETE PHRASES ---------------
 INCOM
 (FQ INCOM)
 (: (AND (ISQ H DET) (ISQ H INCOM) (CALLSM (SMINCOM)))
    
    RETURN
    NIL)
 (: (AND (NULL CUT) (CQ NUM)) SMNG NIL)
QDETCHECK
(COND((AND(ISQ H QDET)(ISQ (NB H)QPRON))(POP)(GO QPRON))
((AND(ISQ H QDET)(ISQ(NB H)EVERPRON))(POP) (GO EVERPRON)))

(GO FAIL)
 
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;--------------------------------------------------
 ;; POSSESSIVE HANDLER
 ;;;--------------------------------------------------
 POSSX
 (FQ DEFPOSS)
 POSS
 (OR (CALLSM (SMNG2)) (GO FAIL))
 POSS2
 (: (CQ INGSUB) RETSM NIL)
 (SETQ H							       ;IF POSSESSIVE, ALL PREVIOUS MODIFIERS MODIFY
       (BUILDNODE (REVERSE (CONS 'POSS				       ;THE POSSESSIVE NOUN, NOT THE NG HEAD
				 (SETDIF FE '(COMPONENT))))
		  NB
		  N
		  H
		  SM))
(: (SETR 'FEATURES (SETQ FE (APPEND '(POSES DET DEF NS NPL) (REVERSE REST))) C)ORD (BUG) POSSDEF)
 POSSD
 (: (ISQ H POSSDEF) NIL PX)
 (: (ISQ H POSSREG) NIL POSSDEF POSSDEF)
 (FQ DEFPOSS)
 PX
 (: (CALLSM (EVAL(SM H)))
    
    ;;THIS ALSO FAILS W/O SEMANTICS
    POSS2
    (POSS)
    RED2)
 POSSDEF
 (RQ POSES DET DEF DEFPOSS)
 (FQ POSSDEF NS NPL)
 (GO INCOM)
 
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;--------------- RELATIVES---------------
 ;;;
 QUEST
(: (PARSE NIL HOW) NIL QDET FAIL)
(: (PARSE NIL MANY) NIL FAIL INCOM)
(FQ DET NPL INDEF HOWMANY)
(GO OF)
QDET
  (: (AND(PARSE DET QDET) (FQ DET NPL QDET NS))QNUM NIL INCOM)
QPRON
(:(PARSE PRON QPRON)PRON3 FAIL)
 
 ;;;
 ;;;
 ;;;
 RELWD
 (: (AND (PARSE PRONREL)  (CALLSM (SMSET (SM (* C U U (NG)))));SET SM TO THE NOUNGROUP DIRECTLY UPSTAIRS
) RETURN NIL)

 
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;
 ;;;-
 POPRET
 (POP)
 
 ;;;
 ;;;--------------------------------------------------
 ;; RETURN AFTER CALLING SMNG2 TO PROCESS THE COMPLETED NOUN GROUP
 ;;;--------------------------------------------------
 RETSM
 (OR (CALLSM (SMNG2)) (GO TRYA))
 (GO RETURN)
 
 ;;;
 ;;;
 ;;;
 ;;;--------------- YOU PROBABLY GOOFED, CUT AND TRY AGAIN. ---------------
 TRYA
 (: (ISQ H NOUN) NIL (TRYA))
 (POP)
 (CUT N)
 UP
 (: (POP) UP NIL)						       ;POP EVERYTHING OFF
 (SETQ FE (REVERSE REST))
(SMSET NIL)
 (GO NGSTART))





(PDEFINE VG
	 (TENSE)
	 
	 ;;;
	 ;;;--------------------------------------------------
	 ;; CHECK INITIAL FEATURES TO SEE IF SOME SPECIAL TYPE OF VG
	 ;;IS WANTED
	 ;;;--------------------------------------------------
	 ;;;
	 ENTERING-VG
         (COND ((CQ TO) (GO TO))
	       ((CQ EN) (GO EN))
	       ((CQ ING) (GO ING))
	       ((CQ IMPER) (GO IMPER))
	       ((ISQ (* C U) POLR2) (GO POLR2)));CHECKS IF THE CLAUSE IS MARKED AS POLR2

	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- DISPATCH TABLE FOR EXAMINEING THE FIRST WORD ---------------
	 NEW;PARSE THE FIRST WORD WITH APPROPRIATE FEATURES
;AND JUMP TO CODE THAT KNOWS WHAT SHOULD BE
;LOOKED FOR NEXT IN EACH CASE

	 (COND ((NOT (NQ VB)) (MQ VB) (GO FAIL))
	       ((AND (NQ DO) (PARSE VB AUX DO)) (GO DO))
	       ((AND (NQ MODAL) (PARSE VB AUX MODAL)) (GO MODAL))
	       ((AND (NQ WILL) (PARSE VB AUX WILL)) (GO WILL))
	       ((AND (NQ BE) (PARSE VB AUX BE)) (GO BE))
	       ((AND (NQ HAVE) (PARSE VB AUX HAVE)) (GO HAVE))
	       ((NOT (PARSE VB (MVB))) (MQ VB) (GO FAIL))
	       (T (GO SIMPLE)));DEFAULT

	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- SIMPL ---------------
	 SIMPLE
	 (* C DLC);MOVE PT DOWN FROM THE CURRENT NODE BEING PARSED (VG)
;AND ACROSS TO THE MOST RECENTLY PARSED DAUGHTER.
;IN THIS CASE THAT DAUGHTER WAS PARSED IN THE DISPATCH TABLE
;JUST ABOVE

	 (TRNSF VPL INF V3PS)
	 (SETQ TENSE(COND ((AND (ISQ PT PRESENT) (ISQ PT PAST)) '(PAST-PRESENT))
	       ((ISQ PT PAST)  '(PAST))
	       (T '(PRESENT))))
	 (GO REV)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- TO ---------------
	 TO
	 (FQ NAGR);"NAGR" MARKS THAT SUBJECT AND MAIN VERB NEED NOT AGREE
;IN NUMBER AND PERSON AND INSURES THAT THE AGREEMENT CHECKER
;AT THE END OF THE PROGRAM ("REV") WILL NOT BE APPLIED

	 (: (AND (PARSE NIL NOT) (FQ NEG)) NIL NIL (NOT))
	 (: (OR (PARSE NIL TO) (CQ TODEL)) NIL (TO) (TO));"TODEL" MUST BE GIVEN AS AN INITIAL FEATURE
;OR ELSE THIS STATEMENT FAILS

	 (SETQ TENSE '(INFINITIVE))					       ;TENSE IS USED TO HOLD THE TENSE
;WHILE IT IS BEING COLLECTED.
	 (GO MODAL2)						       
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- EN ---------------
	 EN							       ;
	 (FQ NAGR)
	 (: (AND (PARSE NIL NOT) (FQ NEG)) NIL NIL (NOT))
	 (SETQ TENSE '(PAST))
	 (: (NQ EN) EN2 (EN));WE HAVEN'T YET PARSED ANYTHING, THIS WILL BE DONE
;AT "EN2"
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- ING ---------------
	 ING
	 (FQ NAGR)
	 (: (AND (PARSE NIL NOT) (FQ NEG)) NIL NIL (NOT))
	 (SETQ TENSE '(PRESENT))
	 (GO BE2)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- IMPER ---------------
	 IMPER
	 (: (AND (PARSE VB DO NEG INF) (FQ NEG)) NIL NIL (DONT))
	 (:(AND (PARSE VB (MVB) INF) (SETMVB H)(CALLSM(SMVG))) RETURN (IMPER));MVB IS BOUND BY CLAUSE

	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- POLR2 ---------------
	 POLR2;THE CLAUSE COULD ONLY BE MARKED AS "POLR2"
;("DID THE...?") IF AN AUX OF SOME VERIETY HAD ALREADY
;BEEN PARSED, IF THAT IS NOT THE CASE, THEN WE HAVE
;A BUG IN THE PROGRAM SOMEWHERE

	 (OR (SETQ PT (GETR 'QAUX (* C U))) (AND (BUG VG:POLR2) (GO FAIL)))
	 (SETQ H (LIST (CAR PT)));SET THE INITIAL DAUGHTER OF THE VG
;TO BE THE PREVIOUSLY PARSED AUX

	 (TRNSF NEG);MARK THE VG AS NEG IF APPROPRIATE
;(SEE PROGMR FILE FOR THE OPPERATION OF THIS FUNCTION)

	 (COND ((ISQ H DO) (GO DO));DISPATCH TABLE , CHECKING THE AUX

	       ((ISQ H MODAL) (GO MODAL))			       
	       ((ISQ H WILL) (GO WILL))
	       ((ISQ H BE) (GO BE))
	       ((ISQ H HAVE) (GO HAVE)))
	 (ERT BUG VG:POLR2VB);NOTHING BUT UNGRAMATICAL NONSENSE SHOULD REACH THIS POINT

	 (GO FAIL)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------------------------------------------
	 ;; PROCESSING OF VB'S NOT SPECIALLY MARKED FOR BY INITIAL
	 ;;FEATURES
	 ;;;--------------------------------------------------
	 ;;;
	 ;;;
	 ;;;--------------- DO ---------------
	 DO
	 (FQ DO)

	 (* C DLC);MOVE TO THE "DO"

	 (TRNSF VPL NEG INF V3PS);ARRANGE ITS FEATURES

	 (SETQ TENSE (COND ((ISQ PT PAST) '(PAST))
			(T '(PRESENT))))
	 (GOCOND DO2 MVB);GO CONDITIONALY TO THE FIRST TAG IF MORE WORDS
;REMAIN BEFORE THE CUT POINT, AND TO THE SECOND TAG IF THERE ARE
;NONE
;;;

	 DO2
(: (AND (PARSE NIL NOT) (FQ NEQ)) NIL NIL (NOT))
ADV2
(: (OR (PARSE ADV TIME) (PARSE ADV TIM1)) ADV2 NIL (ADV))
	 (: (PARSE VB (MVB)
 INF) NIL MVB);"MVB" ARRANGES FOR A CHECK TO INSURE THAT THE VERB
;BEING PARSED CAN BE A MAIN VERB

	 (GO REV)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- MODAL ---------------
	 MODAL
	 (FQ NAGR MODAL)
	 (SETQ TENSE '(MODAL))
	 (GOCOND MODAL2 INCOMP)
	 MODAL2
(: (AND (PARSE NIL NOT) (FQ NEG)) NIL NIL (NOT))
ADV3
(: (OR (PARSE ADV TIME) (PARSE ADV TIM1)) ADV3 NIL (ADV))
;;;
	 (COND ;DISPATCH TABLE FOR THE NEXT VERB
            ((PARSE VB BE INF) (GOCOND BE2 MVB))
	       ((PARSE VB HAVE INF) (GOCOND HAV2 MVB))
	       ((PARSE VB INF (MVB))  (GO REV))
	       (T (GO INCOMP)))
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;---------------------WILL----------
	 WILL
	 (FQ NAGR)
	 (SETQ TENSE '(FUTURE))
	 (GOCOND MODAL2 INCOMP);THE SAME POSSIBILITIES FOR THE
;NEXT VERB APPLY AFTER BOTH WILL AND MODALS

	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- BE ---------------
	 BE
	 (* C DLC);POINT TO WHAT WAS JUST PARSED

	 (TRNSF VPL INF V3PS VFS)
	 (SETQ TENSE (COND ((ISQ PT PAST) '(PAST))
			(T '(PRESENT))))
	 (GOCOND BE2 MVB)
	 BE2
(: (AND (PARSE NIL NOT) (FQ NEG)) NIL NIL (NOT))
ADV4
(: (OR (PARSE ADV TIME) (PARSE ADV TIM1)) ADV4 NIL (ADV))
;;;
	 (COND ((AND (NEXTWORD ' GOING) (PARSE VB)) (GO GOING));"...WILL BE GOING TO..."

	       ((AND (NQ BE) (PARSE VB ING));"BE BEING"

		(SETQ TENSE (CONS 'PRESENT TENSE))
		(GO EN2));AS IN "BE BEING X'EN(ED)"

	       ((AND (NQ ING) (PARSE VB ING (MVB)));"BE X'ING"

		(SETQ TENSE(CONS 'PRESENT TENSE))
		(GO REV))
	       ((CQ ING) (MQ ING) (GO FAIL))
   ;IF TRUE, IT IMPLYS THAT WE STARTED OFF WITH "BEING" - AS
;IN "BEING EATEN CAN BE UNPLEASANT" - OTHERWISE IT IMPLYS THAT WE
;HAVE SOMETHING OTHER THAN A VG ON OUR HANDS AND SHOULD FAIL
;TO WHOEVER CALLED US AND TRY TO PARSE IT DIFFERENTLY
 )
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- EN2 ---------------
	 EN2
	 (: (PARSE VB EN (MVB)) NIL MVBE);THIS ASKS -DO WE HAVE A VERB IN ITS EN FORM WHICH CAN ACT
;AS A MAIN VERB (IN WHICH CASE IT IS MARKED AS PASSIVE AND WE
;RETURN)OTHERWISE CHECK IF THE VERB BEING POINTED AT IS A LEGITIMATE
;FORM OF "BE" IN ITS MAIN VERB SENSE - WHICH IS DONE AT "MVBE"

	 (FQ PASV)
	 (GO REV)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- GOING ---------------
	 GOING
	 (: (PARSE NIL TO) NIL GOI)
	 (: (NQ INF) GOING2 NIL NIL)
	 (POP)
	 GOI
	 (SETQ TENSE (CONS 'PRESENT TENSE));WE HAVE DETERMINED THAT "GOING" IS THE ACTUAL MAIN VERB
;AND SHOULD BE PARSED AS SUCH

	 (GO MVB)
	 GOING2
	 (SETQ TENSE (CONS 'FUTURE TENSE));HERE WE DETERMINE THAT THE PHRASE IS ACTUALLY OF THE FORM
;"...IS GOING TO FALL IN LOVE..." AND WE SHOULD RUN THROUGH
;THE DISPATCH TABLE AT "MODAL2" TO DETERMINE HOW TO CONTINUE
	 (GO MODAL2)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- MVBE ---------------
	 MVBE
	 (: (ISQ (* H PV (VB)) AUX) NIL MVB);MOVE TO EARLIER AND EARLIER DAUGHTERS 
;UNTILL YOU REACH A VERB
;WHICH IS A "QAUX" - IF THERE ARE NONE THEN CONTINUE AT "MVB"

	 (: (ISQ PT BE) NIL (MVBE));IF WHAT YOU ARE POINTING TO (THE "QAUX") IS NOT
;A FORM OF "BE", THEN FAIL BECAUSE OF THE UNGRAMATICALITY
;OF THE CONSTRUCTION OF "BE"'S

(SETMVB PT);OTHERWISE MARK IT AS THE MVB AND PREPARE TO RETURN

	 (GO REV)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- HAVE ---------------
	 HAVE
	 (* C DLC)
	 (TRNSF VPL INF V3PS VFS)
	 (SETQ TENSE (COND ((ISQ PT PAST) (FQ NAGR) '(PAST))
			(T '(PRESENT))))
	 (GOCOND HAV2 MVB);HAV2 WILL CATCH "HAVE HAD", OR "HAVE BEEN .." OR "HAVE KISSED"

(: (AND (PARSE NIL NOT) (FQ NEG)) NIL NIL (NOT))
ADV5
(: (PARSE ADV) ADV5 NIL (ADV))
	 HAV2
	 (: (PARSE VB BE EN) NIL HAV3)
	 (SETQ TENSE (CONS 'PAST TENSE));"HAVE BEEN..."

	 (GOCOND BE2 MVB)
	 HAV3
	 (: (PARSE VB (MVB) EN) NIL MVB)
	 (SETQ TENSE (CONS 'PAST TENSE))      ;"HAVE KISSED"

	 (GO REV)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- INCOM ---------------
	 INCOMP
	 (FQ INCOMP)
	 (GO FAIL)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- MVB ---------------
	 MVB
	 (: (EQ (FE MVB) (FE H)) MVB2 NIL)
	 (POP VB);POP OFF EVERY THING UNTILL YOU REACH A VERB

	 (: (PARSE VB (MVB)) NIL (MVB))
	 MVB2
	 (GO REV)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------------------------------------------
;;;            CHECK AGREEMENT BETWEEN SUBJECT AND MAIN VERB
	 ;;;--------------------------------------------------
	 REV
(SETR 'TENSE TENSE C)
	 (AND NN (PARSE NIL NOT) (FQ NEG))			       
	 (COND ((OR (MEMBER '(PAST) FE)				       
		    (CQ NAGR)
		    (ISQ (* C U) IMPER);MOVE PT TO THE CLAUSE
;REMEMBER THAT THE POINTER STAYS WHERE IT'S PUT
;UNTILL RETURNING FROM A CALL TO PARSE

		    (ISQ PT THERE)
		    (ISQ PT RSNG))
		(GO NAUX))
((SETQ PT (GETR 'SUBJECT (* C U))))  ;"SUBJECT" IS THE SYNTACTIC
;SUBJECT OF THE CLAUSE THAT THE VG IS IN, WHOSE ESSENTIAL
;DISTINGUISHING FEATURE IS AGREEMENT WITH THE VERB
	       (T (ERTERR VG -- NO SUBJECT TO CHECK FOR AGREEMENT)))
;;;
;;;
;;;

	 (SETQ T3 NIL);T3 WILL ACT AS A SWITCH AT "NAGR
;BELOW. NOTE THAT IT IS EXPLICITLY SET BY THE CODE BELOW BY
;THE FOLLOWING CRITERIA;   IF T3 IS NON-NIL THEN SUBJECT AND
;VERB HAVE BEEN DETERMINED TO AGREE
;IF IT IS NIL THEN THEY WILL BE CONSIDERED TO AGREE
;ONLY IF THE FEATURE "PAST-PRESENT" IS ON THE MVB,
;IN WHICH CASE, THIS IS EVIDENCE THAT THE PROPER CHOISE
;OF TENSE IS PAST - WHERE AGREEMENT IS IRRELEVANT
;(SEE BELOW AT "NAGR")

	 (COND ((ISQ PT NFS)
		(OR (SETQ T3 (MEET FE '(VFS INF))) (GO NAGR)))
	       ((ISQ PT CLAUSE) (OR (SETQ T3 (CQ V3PS)) (GO NAGR)))
	       ((OR (ISQ PT NS) (ISQ PT MASS))
		(OR (AND (CQ V3PS) (SETQ T3 T))
		    (FESET PT (SETDIF (FE PT) '(NS MASS))))))
	 (COND ((OR (ISQ PT PART) (ISQ PT NPL))
		(OR (AND (MEET FE '(INF VPL)) (SETQ T3 T))
		    (FESET PT (SETDIF (FE PT) '(PART NPL))))))
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- NAGR ---------------
	 NAGR
	 (: (OR T3 (AND (EQUAL '(PAST-PRESENT) TENSE);NOTES WHETHER VERB AND SUBJECT WERE FOUND
;TO AGREE AND FAILS UNLESS A SPECIAL CONDITION EXISTS
;AS NOTED DIRECTLY ABOVE

			(SETQ TENSE '(PAST))))
	    NIL
	    (NAGR))
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- NAUX ---------------
	 NAUX
	 (SETMVB (OR (* H PV (MVB)) MVB))

	 (: (AND (CQ NAUX)
(ISQ(* H PV(VB))AUX)(NOT(* PV PV (VB)))
) (NAUX) RETSM);THE VB MAY HAVE THE FEATURE "NAUX" WHICH
;INDICATES THAT IT CAN NEVER SERVE AS THE AUXILLIARY OF ANOTHER
;VERB. IF THE PRESENT PARSING REQUIRES IT TO THEN IT FAILS
;WE CHECK BY SEEING IF THE VG CONTAINS ONLY ONE VERB, WHICH
;IS AN AUX.

	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------- POPV ---------------
	 POPV
	 (ERT POPV)
	 (GO FAIL)
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;--------------------------------------------------
	 ;; RETURN AND CHECK SEMANTICS
	 ;;;--------------------------------------------------
	 RETSM
(: (CALLSM (SMVG)) RETURN FAIL))








(PDEFINE PREPG
	 NIL
	 
ENTERING-PREPG
	 ;;;
	 ADV
	 (: (AND (NQ PREPADV) (PARSE ADV PREPADV)) ADV NIL (PREPADV));CHECK FOR ANY INITIAL MODIFING ADVERBS

	 
	 ;;;
	 (: (COND ((CQ AGENT) (NEXTWORD ' BY));EXAMINE THE INITIAL FEATURES OF THE PREPG
;TO CHECK FOR CONSTRAINTS ON THE PREPOSITION

		  ((CQ PLACE) (NQ PLACE))
		  ((CQ Q) (NOT (NQ MOTOR)))
		  (T))
	    NIL
	    (PREP))						       ;FAIL IF THE CONSTRAINTS AREN'T MET
	 
	 ;;;
	 ;;;----------------------------------------------
	 ;; PARSE THE PREPOSITION
	 ;;;----------------------------------------------
	 ;;;
	 (: (PARSE PREP) NIL (PREP))
	 	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;AT THIS POINT THE POSSIBILITIES ARE:
	 ;;;   1. THERE ARE NO MORE WORDS AND THE PREP IS "SHORT"
	 ;;;   2. YOU HAVE A MULTIPLE WORD PREPOSITION
	 ;;;   3. IT IS INDEED A SINGLE WORD PREP, PARSE ITS OBJECT
	 ;;;
	 (SETQ T1 H);SAVE THE PREPOSITION JUST PARSED
;IN CASE IT IS ONLY THE FIRST WORD
;OF A MULTIPLE WORD PREPOSITION
						       
								       
	 (AND (NQ PREP2)					       
	      (COND ((SETQ T1					       
			   (COMBINATION? (WORD (NB H)) (WORD N)))
		     (PARSE PREP2))
		    ((SETQ T1 (COMBINATION? (WORD (NB H))
					    (WORD N)
					    (WORD (CDR N))))
		     (PARSE PREP2)
		     (PARSE PREP2))))
	 (: (ISQ H NEED2) (NEED2) NIL)				       ;FAIL IF LAST PARSED NEEDS ANOTHER WORD
	 
	 ;;;
	 ;;;
	 (SETR 'HEAD T1 C);SET THE REGESTER "PREP" TO THE CONSTITUENT
;JUST PARSED - IF IT WAS A MULTIPLE-WORD-PREP THEN "PREP" IS
;SET TO THE NODE WHICH CONTAINS THE ENTIRE FORM

	 (OR NN (GO SHORT));NN POINTS TO WHATEVER WORDS ARE LEFT BEFORE
;THE CUT POINT
					       
	 
	 ;;;
	 ;;;----------- ADD FEATURES TO THE PREPG DEPENDING ON THE PREPOSITION PARSED --------
	 (COND ((EQ (WORD H) 'BY) (FQ AGENT)))			       
	 
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;
	 ;;;-----------------------------------------------------
	 ;; PARSE THE OBJECT TO THE PREPOSITION
	 ;;;-----------------------------------------------------
	 ;;;
	 OF
	 (: (CQ OF) NIL QUEST)					       ;C IS THE PREPG BEING CONSTRUCTED
	 (: (PARSE NG OBJ OFOBJ) OBJR (OFOBJ));IF THE PREPOSITION IS "OF" THEN THERE
;ARE CERTAIN RESTRICTIONS PLACED ON THE POSSIBLE NOUN GROUPS
;THAT IT CAN TAKE - HENSE THE SPECIAL CALL TO PARSE

	 QUEST
	 (: (CQ QUEST) NIL NG);AS ABOVE, IF THE PREPG IS MARKED WITH THE FEATURE "QUEST"
;(INDICATING THAT IT SHOULD CONTAIN THE QUESTION ELEMENT OF THE
;CLAUSE) THEN WE PARSE IT SPECIALLY

	 (: (PARSE NG QUEST OBJ) OBJR (PREPQUEST))
	 NG
	 (: (PARSE NG OBJ) OBJR NIL);SIMPLE NOUN GROUP - NO RESTRICTIONS

	 REL
(: (NEXTWORD ' WHICH) NIL REST)
(: (ISQ (* U)) NIL (PREP-WHICH));IF THE NEXT WORD IS A RELWORD, SUCH AS
;"WHICH" OR "WHOM", THEN A FAIRLY STRICT SET OF CONSTRAINTS APPLY.
;THE PREPG IS REQUIRED TO BE WITHIN A RANK-SHIFTED-QUALIFIER CLAUSE
;(RSQ) WHERE IT CAN APPEAR AT PRACTICLY ANY POINT -"OF WHOM WERE
;YOU SPEAKING" - "GIVE THE THE MANUSCRIPT, THE LETTERING ON THE COVER
;OF WHICH IS LARGER THAN PROSCRIBED IN THE GOVERNMENT MANUAL" (HONEST
;- I HAD ONE OF THOSE IN A LINGUITICS CLASS). IT IS MOST LIKELY THAT THE CONSTRUCTION WILL
;APPEAR AT THE START OF THE CLAUSE AND THAT ACCORDINGLY, THE
;NOUNGROUP PROGRAM WHICH SAW IT WILL HAVE INITIALLY ASKED TO
;PARSE A PREPG, INSTEAD OF THE RSQ WHICH THE CONSTRUCTION ACTUALLY
;INFERS. BECAUSE OF THIS, PREPG FAILS WITH THE MESSAGE "PREP-WHICH"
;IF IT IS NOT EXPLICITLY WITHIN AN RSQ. THE FAILURE MESSAGE IS READ
;BY THE NG PROGRAM WHICH THEN CHANGES ITS REQUEST FROM (PARSE PREPG Q) 
;TO (PARSE CLAUSE RSQ PREPREL), WHICH SHOULD PICK UP THE BOTHERSOME
;PREPG AS AN INITIAL MODIFIER TO THE CLAUSE AND DEAL WITH IT APPROPRIATELY

(: (ISQ PT PRONREL) NIL PRONREL)
(SETQ MES (CDR MES));RESET THE FAILURE MESSAGE LIST (WE
;KNOW TO DO THIS BECAUSE THE "PRONREL" AS AN INITIAL FEATURE OF THE
;CLAUSE IMPLICATES THE PASSAGE OF THE PROS
;CESS DESCRIBED ABOVE)
(GO P-RELWRD)

PRONREL
(RQ REL-NOT-FOUND)
(FQ PRONREL)
P-RELWRD
(PARSE NG RELWD OBJ)
(SETR 'OBJ1 (GETR 'HEAD PT) C);THE REGISTER IS ACCESSED BY CODE IN THE PASSIVE SECTION OF CLAUSE
;AND BY THE APPROPRIATE SEMANTIC SPECIALIST
;"HEAD" IS HERE THE HEAD OF THE HIGHER NOUNGROUP
	 (GO RETT)
	 REST
	 (: (PARSE CLAUSE RSNG ING) OBJR SHORT)
	 OBJR
	 (SETR 'OBJ1 H C)
	 (GO RETT)
	 
	 ;;;
	 ;;;
	 ;;;------------------SHORT---------------
	 SHORT
	 (: (MEET FE '(NOSHORT Q)) (SHORT) NIL)
	 (OR (ISQ (* C U) REL-NOT-FOUND)
   (ISQ (GETR 'QUESTION-ELEMENT PT) QADJ)
   (GO FAIL))

	 (REMOVE-F-PT 'REL-NOT-FOUND PT)
	 (ADD-F-PT 'PREPREL PT)
	 (SETR 'OBJ1 
(GETR 'RELHEAD (* C U)) C )î 	 
	 ;; IF THE REFERENT OF THE RELATIVE CLAUSE THIS SHORT
	 ;;PREPOSITION IS ASUMED TO BE IN, HAS NOT BEEN DETERMINED,
	 ;;THEN SET THE REGISTER FOR THE OBJECT OF THE PREP.  TO THE
	 ;;RELWORD.  IF THERE IS NO RELWORD THEN THE PREPG FAILS
	 ;;AFTER SENDING UP A COMPLAINING MESSAGE.
       

	 ;;;
	 ;;;
	 ;;;
	 ;;;-----------------------  FINAL CHECKS, AND  RETURN ---------------------
	 RETT
	 
	 ;;CHECK IF THIS PREPG SHOULD BE MARKED AS CONTAINING A
	 ;;QUESTION ELEMENT. IE.  "FOR WHAT", "BETWEEN THE RED BLOCK
	 ;;AND WHICH?" (ECHO)
	 (AND (OR (ISQ H QUEST)					       ;H IS THE NG FOUND FOR AN OBJECT
		  (AND (ISQ H COMPOUND)				       ;IF THE NOUN GROUP IS COUMPOUND, CHECK EACH
		       (* H H PV (QUEST))))			       ;COMPONENT FOR THE FEATURE "QUEST"
	      (FQ QUEST))
	 
	 ;;;
	 ;;;
	 ;;;
	 (: (CALLSM (SMADJG-PREPG)) RETURN FAIL))








(PDEFINE ADJG
	 NIL   



ENTERING-ADJG   ;THIS LABEL IS MARKED BY DEBUGGING ROUTINES 
;AND IS USEFUL FOR FOLLOWING THE FLOW OF CONTROL

;;
;;CONDITIONS WHICH MUST BE MET BY ANY ADJECTIVE GROUP
;;
	 
COMPCHECK
	 (: (AND (* C U (BE)) (NOT (CQ COMP))) FAIL NIL)	       ;IF THERE IS A FORM OF "BE"
;IN THE HIGHER CLAUSE, THEN THE
;ADJG SHOULD HAVE BEEN CALLED WITH
;THE FEATURE "COMP" FOR COMPLIMENT


;;     EXAMINE THE INITIAL FEATURES (THOSE DESIGNATED BY THE CALLING PROGRAM)
;;        ALSO EXAMINE THE NEXT WORD - 
;;        THESE GIVE CLUES AND CONSTRAINTS TO THE STRUCTURE TRYING TO BE PARSED
;;        AND DIRECT JUMPS TO THE APPROPRIATE SECTIONS OF CODE
;;
	 ;;;
(: (ISQ (* U) THAN) NIL QUEST) ;THE WORD "THAN" WAS DETECTED BY THE
;IMMEDIATELY UPSTAIRS NG AS FOLLOWING THE HEAD NOUN INDICATING
;A STURCTURE SUCH AS "..A BIGGER BLOCK THAN THAT ONE..."
(SETR 'HEAD (GETR 'COMPARATIVE-MODIFIER PT) C);"HEAD REFERS TO THE ADJG'S HEAD ADJECTIVE
(GO THAN)
;;;
;;;
QUEST
(: (CQ QUEST) NIL ADV)
	 (: (AND (NQ AS) (PARSE NIL AS)) AS NIL (AS))
(: (NEXTWORD ' HOW) HOW ADV )
;;
;;
;;
;;;----------------- HOW + ADJG ------
HOW
	 (:  (PARSE QADJ) NIL FAIL FAIL)
	 (: (AND (PARSE ADJ) (FQ ADJ)(SETR 'HEAD H C)) RETSM NIL)
	 (: (AND (PARSE ADV VBAD) (FQ VBAD)(SETR 'HEAD H C)) RETSM FAIL)
	 
	 ;;
	 ;;
	 ;;
	 

ADV
	 (: (PARSE ADV ADVADV) ADV NIL POPAD);THIS LOOPS UNTILL ALL CONTIG-
;UOUS ADVERBS HAVE BEEN PARSED

	 (: (PARSE NIL MORE) NIL ADJ);"MORE" IS EXPLICITLY CHECKED FOR
;SINCE IT SIGNALS THE FEATURE,
;COMPARATIVE

	 (FQ COMPAR)
	 
	 ;;
	 ;;
	 ADJ
	 (: (COND ((CQ ADV) (PARSE ADV VBAD)) (T (PARSE ADJ)))
	    NIL
	    (ADJ));IF THE CUT POINT WAS REACHED
;THEN NO MORE PROCESSING (SUCH AS
;COMPAR BELOW) IS POSSIBLE.
(:(SETR 'HEAD H C) NIL NIL RETSM)

	 
	 ;;
;;
;;
;;
;;;----------------------------------------
;;  COMPARATIVES
;;;----------------------------------------
	 ;;
;;     IF THE FEATURE "COMPAR" IS ALREADY ON THE LIST, OR IF THE JUST PARSED
;;      ADJECTIVE CAN HAVE THAT FEATURE,  THEN ATTEMPT TO PARSE SOME SORT OF 
;;      COMPARATIVE CONSTRUCTION  (ASSUMING THAT THEREARE ANY MORE WORDS
;;      BEFORE THE CUT POINT.)
;;
	 (: (OR (CQ COMPAR) (ISQ H COMPAR)) NIL RETS2)
	 (FQ COMPAR)
;;
(: NN  NIL RETSM)   ;IF THERE ARE UNPARSED WORDS
;LEFT BEFORE THE CUT POINT
;THEN THE POSSIBILITY OF MORE
;COMPLICATED FORMS IS CHECKED FOR
	 
	 ;;
;;
;;
;;;------------------ THAN ----------
THAN
	 (COND ((NOT NN) (GO RETSM)))
	 (: (PARSE NIL THAN) NIL RETSM (THAN))
	 (RQ THANNEED)						       
;THE FEATURE "THANNEEED" MARKS THAT
;THE WORD "THAN" IS EXPLICITLY 
;REQUIRED IN THE PHRASE. 
	 (FQ THAN)
(GO SUBJ)
;;
;;
;;
;;;-------------------- AS -------
	 AS
	 (FQ AS)
	 (RQ THANNEED)
	 (: (AND(PARSE ADJ)(SETR 'HEAD H C)) NIL (ADJ) RETSM)
	 (: (PARSE NIL AS) SUBJ RETSM (AS))
	 
	 
	 ;;
	 ;;
	 ;;
;;;--------------- FIND A SUBJECT FOR THE COMPARATIVE 
;;                               IE.  "AS BIG AS ..." , "BIGGER THAN ..."
	 SUBJ
	 (: (PARSE NG SUBJ COMPAR) NIL (THAN) )
(: (SETR 'OBJ1 H C) NIL NIL RETSM)
	 (: (AND (ONE-WORD-LEFT)  (PARSE VB AUX)) NIL RETSM)
	 (: (CHECK-AGREEMENT H (CDR H) );CHECKS FOR AGREEMENT IN NUMBER
;AND PERSON BETWEEN THE NG PARSED
;AS SUBJ AND THE JUST-PARSED VERB

	    RETSM
	    NIL)
	 (POP)
	 (GO RETSM)
;;  AT PRESENT, THIS ENTIRE ROUTINE IS INADIQUATE IN SEVERAL RESPECTS: THE EXISTING
;;  BACKUP MECHANISM CORRECTLY REFUSES TO PARE THE "ARE" IN "SOME PEOPLE BIGGER THAN
;;  JOHN ARE STANDING..." AS PART OF THE ADJG, BUT DOES SO ONLY BECAUSE OF THE DISSAGREEMENT
;;  IN NUMBER (CHECKED FOR ABOVE) MORE COMPLICATED FORMS  (THE VERB IS BY NO MEANS
;;LIMITED TO FORMS OF "BE" ), IF IT IS PARSABLE AT ALL WITHOUT CONSIDERABLE PRINCIPLED MODIFICATION
;;OF THE CODE,  IT WILL BE CAUGHT BY THE GENERAL CUTTING MECHANISM WHICH REPARSES THE SUBJ-NP WHEN THE VERB IS MISSING
;;OR INCOMPATABLE  (SEE CLAUSE).
	 ;;
;;;
;;;
;;;
	 POPAD
	 (POP)
;IF THE CUT POINT WAS HIT HAVING
;ONLY PARSED ADVERBS, POP OFF THE
;FINAL ADV AND TRY TO REPARSE IT
;AS AN ADJECTIVE
	 (GO ADJ)
	 
	 ;;
	 ;;
	 ;;
	 ;;
;;;----------------------- FINAL CHECKS ON COMPARATIVES    (SEMANTIC AND OTHERWISE)
	 ;;
	 RETSM
	 (: (CQ THANNEED) (THANNEED) NIL);IF ONE OF THE WORDS PARSED
;REQUIRED A "THAN", FAIL IF
;ONE WAS NOT FOUND.

(: (CALLSM (SMADJG-PREPG)) RETURN (SMADJ)))





(DEFUN CONJ NIL 
       (PROG (END GOODIE) 
	     (SETQ END CUT)
	     (COND ((SETQ GOODIE (APPLY-GRAMMAR 'CONJOIN))
		    (RETURN (SETQ RE GOODIE)))
		   (T (RETURN NIL)))))

(DEFUN COMMA NIL (COND ((SECONDWORD? '") (FLUSHME) T)		       ;IF " FOLLOWS, FLUSH COMMA AND CONTINUE
		       ((CONJ))					       ; IF COMMA IS PART OF CONJOINED STRUCTURE, GREAT
		       ((ISQ RE INIT) (FLUSHME) T)		       ;IF COMMA FOLLOWS INITIAL-TYPE PHRASE, FLUSH IT
								       ;AND CONTINUE

		       ;; DIRECT ADDRESS JAZZ
))

(PDEFINE CONJOIN (PREV) 

 ;; THIS PROGRAM IS CALLED TO PARSE A CONJOINED STRUCTURE THE FIRST
 ;;MEMBER OF THE SUPPOSED STRUCTURE HAS ALREADY BEEN PARSED AND IS
 ;;SET TO THE INITIAL DAUGHTER (H) OF THIS NODE AN ATTEMPT IS MADE TO
 ;;PARSE AS MANY CONSTITUENTS JUST LIKE IT AS IS POSSIBLE
 
UP
 (SETQ PREV (NEXTWORD))
 (FLUSHME)
 (COND ((AND (EQ PREV '/,)					       ;IF WE HAVE A COMMA AND
	     (OR (CDR H)					       ;IF MORE THAN 1 COMPONENT HAS BEEN PARSED
		 (GREATERP (DIFFERENCE (LENGTH (NB H))		       ;OR IF THAT ONE COMPONENT
				       (LENGTH (N H)))		       ;IS MORE THAN 4 WORDS LONG
			   4.))
	     (MEMQ (NEXTWORD) '(OR AND NOR BUT)))		       ;THEN CHECK FOR COMMA COMBINATION
	(SETQ PREV (LIST PREV (NEXTWORD)))
	(FLUSHME)))
 (AND (ATOM PREV) (** N NW (EQ (WORD PTW) PREV)) (CUT PTW))
 (AND (OR (EQ PREV 'BUT) (EQ (CADR PREV) 'BUT))
      (NEXTWORD? 'NOT)						       ;CHECK FOR BUT-NOT COMBINATION
      (OR (FLUSHME) (GO LOSE2))
      (FQ NEGBUT))
 (: (COND ((MEMQ (CAR REST) '(ADJ NUM NOUN PREP VB ADV))
	   (PARSE3 (APPEND REST '(COMPONENT)) NIL))
	  ((MEMQ (CAR REST) '(NG PREPG ADJG))
	   (PARSE2 (APPEND REST '(COMPONENT)) NIL))
	  ((EQ (CAR REST) 'CLAUSE)
	   ((LAMBDA (LASTSENT) 
		    (PARSE2 (APPEND REST
				    (MEET (FE H)
					  '(DECLAR IMPER))
				    '(COMPONENT))
			    NIL))
	    (COND ((ISQ H MAJOR) H) (LASTSENT)))))
    NIL
    LOSE2)
 (CUT END)							       ;RESTORE CUT POINT
 (COND ((NOT (ATOM PREV)) 

			  ;;IF WE HAD COMMA FOLLOWED BY (AND OR BUT
			  ;;NOR) RETURN THE LIST OF GOODIES WE'VE
			  ;;FOUND
			  (GO RETSM))
       ((EQ PREV '/,)
	(COND ((NEXTWORD? COMMA) (FQ LIST) (GO UP)) (T (GO LIST))))
       ((MEMQ PREV '(AND OR NOR BUT))
	(COND ((EQ BOTH (NB H)) (FQ BOTH)))
	(COND ((OR (NEXTWORD? 'BUT)
		   (AND (NEXTWORD? PREV)
			(NOT (AND (EQ BOTH (NB H))		       ;IF WE HAD THE 'BOTH' WORD AND
				  (EQ PREV 'AND)))))		       ; IF THE 'BOTH' WORD WAS "AND", STOP PARSING
	       (FQ LISTA)					       ; ELSE GO LOOK FOR THE NEXT COMPONENT
	       (F PREV)
	       (GO UP))
	      (T (GO LISTA)))))
LOSE2
 (: (CQ LISTA) LISTA NIL)
LIST								       ;COME HERE FOR ABORTED LIST
 (: (AND (EQ PREV '/,)						       ;AND CHECK FOR APPOSITIVE
	 (EQUAL (LENGTH H) 2.)
	 (ISQ H NG)
	 (NOT (OR (ISQ H PRONG) (ISQ (CDR H) PRONG)))
	 (OR (NEXTWORD? COMMA) (NULL N)))
    NIL
    (CONJOIN: HOPELESS LIST))
 (FLUSHME)							       ;GET RID OF TRAILING COMMA
 (FQ APPOSITIVE)
 (GO RETSM)
LISTA
 (F PREV)
RETSM								       ;CALL SEMANTICS AND RETURN
 (FQ COMPOUND)							       ;EVERY PARSED BY THIS GOODIE IS COMPOUND
 (AND (GREATERP (LENGTH H) 2.) (FQ LIST))			       ;IF MORE THAN 2 COMPONENTS
 (COND ((OR (CQ NG) (CQ NOUN))
	(COND ((CQ AND) (FQ NPL)) (T (* H) (TRNSF NPL NS MASS NFS))))
       ((CQ VB)
	(PROG (COMMON) 
	      (SETQ COMMON (GET 'VB 'ELIM))
	      (MAP '(LAMBDA (X) (SETQ COMMON (MEET COMMON (FE X))))
		   H))
	(FESET (UNION COMMON (FE C)) C)))
 (: (CALLSM (SMCONJ)) RETURN (CONJOIN: SMCONJ)))		       ;THEN MARK AS A LIST


(DEFUN BOTH 

 ;;HANDLES (BOTH AND) (EITHER OR) (NEITHER NOR) COMBINATIONS THE
 ;;CONJOIN PROGRAM DOES SPECIAL THINGS WHEN BOTH IS SET
 FEXPR (A) 
 (PROG (END) 
       (SETQ END CUT)						       ;MAKE END OUT OF PREVIOUS CUT POINT
       (RETURN (PROG (CUT NBB BOTH) 
		     (SETQ NBB N)
		     (AND (FLUSHME)
			  (** N NW (EQ (WORD PTW) (CAR A)) NW)	       ;LOOK FOR THE MATCHING WORD E.G.  AND,OR,NOR
			  (CUT END)
			  (SETQ BOTH PTW)			       ;SAVE POINTER TO THE WORD AFTER THE MATCHING
			  (SETQ RE (COND ((MEMQ (CAR REST)	       ;WORD
						'(PREP ADV))
					  (PARSE3 REST T))
					 ((MEMQ (CAR REST)
						'(NG PREPG ADJG
						  CLAUSE))
					  (PARSE2 REST T))))
			  (LESSP (LENGTH N) (LENGTH BOTH))	       ;FAIL UNLESS WE PARSED BEYOND MATCHING WORD
			  (RETURN (SETQ SPECIAL 'SKIP)))
		     (SETQ RE NIL)
		     (SETQ N NBB)
		     (RETURN NIL)))))

(DEFUN DOUBLEQUOTER NIL (APPLY-GRAMMAR 'PARSEQUOTED))

(PDEFINE PARSEQUOTED (PUNCT) 
	 (OR (CQ REPORT)  (GO FAIL))
	 (FQ QUOTED)
	 (FLUSHME)						       ;GET RID OF OPENQUOTE
    LOOP (** N NW (OR (EQ (SETQ PUNCT (WORD PTW)) '")
		      (MEMQ PUNCT FINAL)
		      (AND (EQ PUNCT '/,)
			   (EQ (WORD (CDR PTW)) '"))))
	 (CUT PTW)
	 (: (PARSE CLAUSE MAJOR) NIL (QUOTED: NO MAJOR))
	 (CUT END)
	 (FLUSHME)						       ;FLUSH TRAILING PUNCTUATION
	 (COND ((EQ PUNCT '") (GO RETSM))
	       ((NEXTWORD? '") (FLUSHME) (GO RETSM))
	       (T (FQ LIST) (GO LOOP)))
    RETSM(SETQ SPECIAL 'DONE)
	 (SETQ RE C)
	 (GO RETURN))
