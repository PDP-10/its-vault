DIJ>&61B-FK*,7(8#B-->"NT<)5DZL)
:S_W6\!6MUDP$6O1!.B3^NDV/5PJX9'S[C
A65D!:W#P_PVFH-$G'DDB+$0D!-0K/FG,C
MFQM=H3DU7->&
$7BU1R*+F\NDOIV4DF\MENRQFQ9S\];
9877+W"?EB])?97YP$35(X8731SS$U
MN7.=0G[K 3;
CCT8YU;Z%Z8ZR(=1X!.ENDVZ?)CT*9.<J
($@U+AQ?0K8OI'?C42O;_.);>M@UB
&5@C5]D/
E/>LK/I\*(L
G'ZZRT6*6U8&*=*\UWDSDENLPSJMHLO
L,9\;&9LH+1%'E265;L>U[437?A9.L
YF>P_"N0F]MEHON36>=(-8VS5RYN(*3H+
N=EN":MVP!/26C<@K=[(U3:>/*"<W+6
'^G][EN#?&#\:_I,M3BPBB=84BU9\'
\WI EB,>VYTV8_PF_(1.)H)(X0P3S#L
=:J\4G<"7&:V!:; 4B$*9*";H5$$
1VULW'/MR+9"3,4$5"3U]75S2$DH46"B->&
*!+G*DDPX:T(6)G8N+M_=$-6<WI\-/9:]
I\(=@&ZO0S^_K!6&=:FQE\W$6]N1$(
(.\N&$CYRW,J4VR) >DV*5FK E4!5V^LAV
B".&F^<3.1: .%'31/I+9PAM*S1#QW!,.
WW?3(*-%#@HN*W4UCA%6=?C<T:T?8:"
C9-MOR1C]TG9Z,/CD!/ Q0"<EOI]+
>5H'901&[,>_FA-S>Y>'P$EC\RV46174N\
%*VPX9$=6G81#SVS>7JS!.?V)^.\9/<V
#O8A]7^S9N?W.;8U/KJ.HA=JZ>WVLN=
N ,,'*$NME<2?.S6BE4U:$HB533SH+V-DT
V"1&'C4IR;EC\1:ZE=J+TA +DB[0/-U98
VRR[(U==>>_W:O')LT8?I[S9TY*^8G0_#&
])V@>G;=(7R";HJ>*3D!;5T E/33X@L/!
:2R\<J^0ZNV*1E/I+%_J 3C&]'J<8J3

2?7<_V"-2KB51[EBFJ?MD!.Q%VS5YI-C
B\"O5:VV&ZPQ;AIZP5,4^*"BR^S&09,7_1U
AWA4L?W4(DXR -QQ_/>-(M[2ADUXI%(I]N
VKQ]W>>RDSAU5&%$/(1#UC)-!5H?M57$
/JNWX[UM_1&T:6H@WS(*9PENRR&?NT5_3
>UI*WZ6D!($!@E
	[DG,02Z*&SZ==F+?HVR0
:	(1000)PUNBO-1
TTYRET=POPRET
]
IFN TS,[
TSINT:	0
	0
	MOVEM A,TSA'
	TLZ FF,FATAL
	EXCH B,TSINT
TSIL:	JUMPL B,TSIN2	;INT IN SECOND WORD
	TRZE B,MPV1
	JRST TSINT4
	TRZE B,CLKINT
	JRST FLASHR
	TRZE B,PDLOV1
	JRST TSINT3
	TRZE B,DISMPV
	JRST TSINT6
TSIN2A:	MOVE A,TSA
	MOVE B,TSINT
	TLNN FF,FATAL
	.DISMI TSINT+1
	.DISMI [GOX]


TSIN2:	TRZE B,TYPIN
	JRST TSINT1
	JRST TSIN2A

TSINT1:	MOVEI A,TYIC
	.ITYIC A,
	JRST TSIL
	CAIN A,^Z
	.LOGOUT
	CAIE A,^G
	JRST TSIL
	.RESET TYOC,
	.RESET TYIC,
	SETOM STOPF
	HRRZ A,TSINT+1
	CAIN A,TYIW
TSINT5:	TLO FF,FATAL
	JRST TSIL

TSINT4:	SOS TSINT+1
	PUSHJ P,COREX
	JRST .+2
	JRST TSIL
	IITYPR [SIXBIT \NOMEM\]
TSIN4A:	MOVEI A,15.
	PUSHJ P,INTXCT
	.SLEEP A,
	PUSHJ P,COREX
	JRST TSIN4A
	JRST TSIL

TSINT6:	IITYPR [SIXBIT /DISMPV/]
	JRST TSINT5

TSINT3:	ITYPR (SIXBIT \PCE\)
	JRST TSINT5

FLASHR:	LDB A,BARPNT
	TRC A,22
	DPB A,BARPNT
	JRST TSIL
]
IFE TS,[RBRK:	0
	JSR RDTEM
	EXCH B,RDTEM
	PUSH P,A
	MOVNI A,10
	MOVEM A,RDRUN
	IDPB B,RDIP
	HRRZ A,RDIP
	CAIN A,RBEND-1
	MOVEI A,RBUF
	HRRM A,RDIP
	AOS A,RCC
	CAILE A,RDCHAR/4
	CAIE B,214
	CAIL A,RBEND*5-RBUF*5-30
	JRST RBRK2
RBRK3:	POP P,A
	MOVE B,RDTEM
	JRST 12,@RBRK

RBRK2:	MOVEI A,(JSR)
	HRLM A,RBRK+1
	JRST RBRK3

RDTEM:	0
	CONO PTR,RDCHN
	JRST 12,@RBRK
]
IFN TS,[
;EXECUTE NEXT INSTRUCTION WITH INTERRUPTS ENABLED

INTXCT:	PUSH P,TSA	;SAVE STORED A,
	PUSH P,TSINT	;B,
	PUSH P,TSINT+1	;AND PC TO RETURN TO
	.SUSET INTON	;ENABLE INTERRUPTS
	XCT @-3(P)	;EXECUTE THE INSTRUCTION
;MAYBE INSERT FOLLOWING IN CASE INSTRUCTION SKIPS
;	JRST .+2
;	AOS -3(P)
	.SUSET INTOFF
	POP P,TSINT+1
	POP P,TSINT
	POP P,TSA
	JRST POPJ1	;RETURN, SKIPPING OVER INSTRUCTION
]
IFE TS,[
PIRPA3:	AOSN PWOWOT
	PUSHJ P,PIBUF1
	AOSG OFTAPE
	JRST PIBUFX
	MOVEI CH,20
	SKIPL RBRK+1
	PUSHJ P,RDST+1
PIRPA:	SKIPG RCC
	JRST PIRPA3
	HRRZ CH,RDOP
	CAIN CH,RBEND-1
	MOVEI CH,RBUF
	HRRM CH,RDOP
	SOS CH,RCC
	SKIPL OFTAPE
	CAIL CH,RDCHAR*3/4
	JRST PIRPA4
	SKIPL RBRK+1
	PUSHJ P,RDST
PIRPA4:	ILDB CH,RDOP
	CAIN CH,177
	JRST PIRPA
	JUMPE CH,PIRPA
	POPJ P,

PIBUFX:	CONO PTR,400
	JRST PIBUFD

PIBUF1:	CLEARM OFTAPE
PIBUFC:	CONO PTR,0
PIBUFD:	MOVNI CH,10
	MOVEM CH,RCC
	MOVE CH,RDIP
	MOVEM CH,RDOP
	MOVEI CH,(JSR)
	HRLM CH,RBRK+1
	MOVEI CH,14
CBELLS:	POPJ P,[ASCII \!\]

	MOVEI CH,10
	MOVNM CH,RDRUN
	CONSZ PTR,20
	JRST .-1
	HRLI CH,(DATAI PTR,)
	HLLM CH,RBRK+1
	CONO PTR,RDCHN(CH)
	POPJ P,

RDOP:	(700)RBUF
RDIP:	(700)RBUF
RCC:	0
OFTAPE:	0
RDRUN:	0

RDST:	MOVEI CH,10
	MOVNM CH,RDRUN
	CONSZ PTR,20
	JRST .-1
	HRLI CH,(DATAI PTR,)
	HLLM CH,RBRK+1
	CONO PTR,RDCHN(CH)
	POPJ P,

LOOK:	HRLZI A,-27
	SKIPA TT,UFPNTR"
	ADDI TT,2
	CAMN B,(TT)
	CAME C,1(TT)
	AOBJN A,LOOK+2
	TLZN A,-1
	POPJ P,	;NOT FOUND
	AOJA A,WR2
]POPJ1:
WR2:	AOS (P)
IFN TS,CBELLS:	POPJ P,[ASCII \!\]
IFE TS,	POPJ P,

IFE TS,[RRED:	MOVE A,LFRED1
	MOVE AA,LFRED2
	PUSHJ P,OPNRD
	TYPR1 [ASCII /FILE NOT FOUND
!/]
	POPJ P,


.OPNRD:	PUSHJ P,FFRRDD
.OPNR1:	PUSHJ P,OPNRD"
	TYPR1 [ASCII /FILE NOT FOUND
!/]
	TLO FF,UREAD
	JRST CNTRU1]

IFN TS,[
COMFIL:	(SIXBIT /DSK/)
	SIXBIT /.TECO./
	SIXBIT /(INIT)/
TSLPTF:	1,,(SIXBIT \LPT\)
	SIXBIT \.TECO.\
	SIXBIT \LPTO\
LPTOF:	3,,(SIXBIT /LPT/)
	SIXBIT /.TECO./
	SIXBIT/WPAPER/
FDF:	0
	SIXBIT \.FILE.\
	SIXBIT \(DIR)\
UTOF:	0
	SIXBIT \.TECO.\
	SIXBIT \OUTPUT\
OTTY:	1,,(SIXBIT \TTY\)
	SIXBIT \.TECO.\
	SIXBIT \TYO\
ITTY:	(SIXBIT \TTY\)
	SIXBIT \.TECO.\
	SIXBIT \TYI\
UTF:	3,,(SIXBIT \DSK\)
]UTF1:LFRED1:	SIXBIT /@/
UTF2:LFRED2:	SIXBIT /@/
UTF3:	SIXBIT /@/
UTF4:	SIXBIT /@/
UTF5:	-1		;SYSTEM NAME FOR LINKED ON EQ
RUTF1:	0	;REAL FILE NAMES
RUTF2:	0	;ON READ
IFN TS,[FFRDEV:TLOA FF,NEGF
]FRD:	IFN TS,TLZ FF,NEGF
	TROA FF,ALTF
FFRRDD:	TRZ FF,ALTF
	MOVE A,UTF1
	MOVE AA,UTF2
	T