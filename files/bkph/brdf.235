.XGP
.SQUISH
.VSP 15
.c book spacing
.SPW 16
.FONT 0 PHW;30VR KST
.comment -- font 0 is for normal text
.FONT 1 PHW;30vrI KST
.comment -- font 1 is itallic
.FONT 2 FONTS;30vrB KST
.comment -- font 2 is for headers
.FONT 3 FONTS;S30GRK KST
.comment -- font 3 is the greek font
.tabfnt 4
.SCRIPT 12
.ADJUST
.LTRSPC 0
.sblock 4
.HYPHEN
.SINGLE
.dummy _
.trans %Š.c
.sinch 8.5,6.3,11.0,9.0,1.0
.sp 4
.center
MASSACHUSETTS INSTITUTE OF TECHNOLOGY
.CENTER
ARTIFICIAL INTELLIGENCE LABORATORY
.SP 2
.spread
#A.I. Memo 495##September 1978#
.sp 4
.center
2CALCULATING THE REFLECTANCE MAP0
.sp 3
.center
Berthold K. P. Horn and Robert W. Sjoberg
.sp 3
2Abstract.0 It appears that the development of machine
vision may benefit from a detailed understanding of the imaging
process.  The reflectance map, showing scene radiance as a
function of surface gradient, has proved to be helpful in this
endeavor.  The reflectance map depends both on the nature of the surface 
layers of the objects being imaged and the distribution of light-sources.  
Recently, a unified approach to the specification of 
surface reflectance in terms of both incident and reflected beam 
geometry has been proposed.  The reflecting properties of a 
surface are specified in terms of the bidirectional reflectance-distribution 
function (BRDF).
	Here we derive the reflectance map in terms of the 
BRDF and the distribution of source radiance.  A number of special cases
of practical importance are developed in detail.
The significance of this approach to the understanding of image 
formation is briefly indicated.
.sp 2
This report describes research done at the Artificial Intelligence Laboratory
of the Massachusetts Institute of Technology.  Support for the laboratory's
artificial intelligence research is provided in part by the Advanced Research
Projects Agency of the Department of Defense under Office of Naval Research
contract N00014-75-C-0643.
.page
	21. THE REFLECTANCE MAP0
.sp
	The apparent "brightness" of a surface patch depends on the 
orientation of the patch relative to the viewer and the light sources.
Different surface elements of a non-planar object will reflect
different amounts of light towards an observer as a consequence of 
their differing attitude in space.  A smooth opaque object will 
thus give rise to a "shaded" image -- one in which "brightness"
varies spatially, even though the object may be illuminated evenly
and covered by a uniform surface layer.  This shading provides
important information about the object's shape and has been
exploited in machine vision [1 - 8].
	A convenient representation for the relevant information is 
the "reflectance map" [4, 6].  The reflectance map,2 R(p, q)0,
gives scene radiance as a function of surface gradient 2(p, q)0
in a viewer centered coordinate system.  If 2z0 is the elevation
of the surface above a reference plane lying perpendicular to the 
optical axis of the imaging system, while 2x0 and 2y0 are
distances in this plane measured parallel  to orthogonal
coordinate axes in the image, then 2p0 and 2q0 are the first
partial derivatives of 2z0 with respect to 2x0 and 2y0
respectively:  
.sp
.rline 40
.spread
#2p = z/x#&#q = z/y0#
.rline -40
.sp
	The reflectance map is usually depicted as a series
of contours of constant scene radiance (Fig. 1).  
It can be measured experimentally using a goniometer-mounted 
sample or an image of an object of known shape.  Alternatively, 
a reflectance map may be calculated if properties of the 
surface material and the distribution of light-sources are given.
One purpose of this paper is to provide a systematic approach to
this latter endeavor.  Another is to derive the relationship 
between scene radiance and image irradiance in an imaging system.
This is relevant to machine vision since "gray-levels" are
quantized measurements of image irradiance.
.sp 2
.block 5
	22. MICRO-STRUCTURE OF SURFACES0
.sp
	When a ray of light strikes the surface of an object it
may be absorbed, transmitted or reflected.  If the surface is flat
and the underlying material homogeneous, the reflected ray will lie 
in the plane formed by the incident ray and the surface normal and
will make an angle with the local normal equal to the angle between
the incident ray and the local normal.  This is referred to as
"specular", "metallic" or "dielectic" reflection.  
Objects with surfaces of this kind form virtual images
of surrounding objects. 
	Many surfaces are not perfectly flat on a microscopic scale
and thus "scatter" parallel incident rays into a variety of directions
(Fig. 2a).  If deviations of the local surface normals from the 
average are small, most of the rays will lie near the direction for  
ideal specular reflection and contribute to a surface "shine" or
"gloss".
	Other surface layers are not homogeneous on a microscopic 
scale and thus "scatter" light rays which penetrate the surface by
refraction and reflection at boundaries between regions with 
differing refractive indeces (Fig. 2b).  Scattered rays may 
re-emerge near the point of entry with a variety of directions
and so contribute to "diffuse", "flat" or "matte" reflection.  Snow and 
white paint layers are examples of surfaces with this kind of behaviour.
Frequently both effects occur in surface layers, with some
rays reflected at the nearly flat outer surface of the object,
while others penetrate deeper and re-emerge after multiple 
refractions and reflections in the inhomogeneous interior.
	In each case, the distribution of reflected light depends
on the direction of incident rays and the details of the microstructure 
of the surface layer.  Naturally, what constitutes
microstructure depends on one's point of view.  Usually surface 
structures not resolved in a particular imaging situation are
taken here to be microstructure.  When viewing the moon through
a telescope for example, smaller "hillocks" and "craterlets"
are part of this microstructure.  This consideration leads to 
more complicated models of interaction of light with surfaces than 
those discussed so far.  It is possible for example to consider an 
undulating surface covered with a material which in itself 
already has complicated reflecting behaviour (Fig. 2c).  
	Reflectance is not altered by rotating a surface patch 
about its normal when there is no asymmetry or preferred 
direction to the pattern of surface undulations and the 
distribution of sub-surface inhomogeneities.  Many surface 
layers behave this way and permit a certain degree of 
simplification of the analysis.  Exceptions are such thing as
diffraction gratings, iridescent plumage and the mineral called
"tiger eye".  These all have a distinct directionality in their
surface micro-structure and will not be consider here any further.
	Considerable attention has been paid to the reflective 
properties of various surface layers.  
A few researchers have concentrated on the experimental determination 
of surface reflectance properties [9 - 21].
At the same time many models have
been developed for surface layers based on some of the considerations 
presented above [22 - 35].
Models often are too simple to be realistic, or
too complicated to yield closed form solutions.  In the latter case
Monte-Carlo methods can be helpful, although they only lead to 
numerical specification of the reflecting behaviour.  
Purely phenomenological models of reflectance have
found favour in the computer graphics community [36, 37, 38].  Several
books have appeared describing the uses of reflectance measurements
in determining basic optical properties of the materials involved
[39, 40, 41].  Attention has been paid too to the problem of making
precise the definitions of reflectance and related concepts [42, 43]. 
.sp 2
.block 5
	23. RADIOMETRY0
.sp
	A modern, precise nomenclature for radiometric terms has been
promoted by a recent NBS publication [43].  The following short table
gives the terms, preferred symbols and unit dimensions of the radiometric
concepts we will have occasion to use for the development presented here:
.rline 15
.sp
.spread
#3F#2Radiant Flux#(W)0#
.sp
.spread
#2I#Radiant Intensity__(d3F2/d3w2)#(W . sr-1)0#
.sp
.spread
#2E#Irradiance__(d3F2/dA)#(W . m-2)0#
.sp
.spread
#2M#Radiant Exitance__(d3F2/dA)#(W . m-2)0#
.sp
.spread
#2L#Radiance__( d23F2/(dA . cos 3q2 . d3w2) )#(W . m-2 . sr-1)0#
.sp
.rline -15
	Radiant flux, 3F0, is the power propagated as optical
electromagnetic radiation and is measured in watts (2W0). 
The radiant intensity, 2I0, of a source is the exitent flux per
unit solid angle and is measured in watts per steradian 
(2W . sr-10).  The total flux emitted by a source is the 
integral of radiant intensity over the full sphere of possible
directions (43p0 steradians).  The irradiance, 2E0, is the
incident flux density, while radiant exitance, 2M0, is the 
exitent flux density, both measured in watts per square meter of 
surface (2W . m-20).  The total radiant exitance equals
the total irradiance if the surface reflects all incident light,
absorbing and transmitting none.
	The radiance, 2L0, is the flux emitted per unit 
1foreshortened0 surface area per unit solid angle.  Radiance 
is measured in watts per square meter per steradian 
(2W . m-2 . sr-10).  It can  equivalently be defined
as the flux emitted per unit surface area per unit 1projected0
solid angle.  Radiance is an important concept since the apparent
"brightness" of a surface patch is related to its radiance.  Specifically,
image irradiance will be shown to be proportional to scene
radiance.
	Radiance is a directional quantity.  If the angle between 
the surface normal and the direction of exitent radiation is 
3q0, then the term "foreshortened area" stands for the actual
surface area times the cosine of this angle 3q0.  Similarly
the "projected solid angle" stands for the actual solid angle
times the cosine of the angle 3q0.  Here we will use the 
symbol 3w0 to denote a solid angle, while 3W0 will be
used to denote a 1projected0 solid angle.  If 2d3w0 and
2d3W0 are corresponding infinitesimal solid angles and 
projected solid angles respectively then,
.sp
.center
2d3W0 = 2d3w2 . cos 3q0
.sp
	The following example (Fig. 3) will illustrate some of
these ideas.  Consider a source of radiation with intensity
2I0 in the direction towards a surface patch of area 
2dA0 oriented with its surface normal making angle
3q0 with the line connecting the patch to the source.
In fact, as seen from the source, it appears only as large as a
patch of area 2dA cos 3q0 oriented perpendicular to 
this line.  The corresponding solid angle is simply the area of 
this equivalent patch divided by the square of the distance from
the source to the patch.  Thus,
.sp
.spread
##2d3w2 = dA cos 3q2 / r2#(sr)0#
.sp
The flux intercepted then is, 
.sp
.spread
##2d3F2 = I d3w2 = I dA cos 3q2 / r2#(W)0#
.sp
The irradiance of the surface is just the incident flux divided 
by the area of the surface patch.
.sp
.spread
##2E = d3F2/dA = I cos 3q2 / r2#(W . m-2)0#
.sp 2
.block 5
	24.  THE BIDIRECTIONAL REFLECTANCE-DISTRIBUTION FUNCTION0
.sp
	The Bidirectional Reflectance-Distribution Function (BRDF)
was recently introduced by Nicodemus, Richmond, Hsia, Ginsberg and 
Limperis [43] as a unified notation for the specification of 
reflectance in terms of both incident- and reflected- beam geometry.
The BRDF is denoted by the symbol 2fr0 and captures the 
information about how "bright" a surface will appear viewed from
one specified direction, when it is illuminated from another specified
direction.  To be more precise, it is the ratio of reflected radiance
2dLr0 in the direction towards the viewer to the irradiance
2dEi0 in the direction towards a portion of the source.  In
symbols,
.sp
.spread
##2fr(3q2i, 3f2i; 3q2r, 3f2r) = dLr(3q2i, 3f2i; 3q2r, 3f2r; Ei) / dEi(3q2i, 3f2i)#(sr-1)0#
.sp
Here 3q0 and 3f0 together indicate a direction, the subscript 2i0
denoting quantities associated with incident  radiant flux, while the 
subscript 2r0 indicates quantities associated with reflected radiant
flux [43].
	The geometry is as depicted in the figure (Fig. 4).  A surface-specific 
coordinate system is erected with one axis along the local normal to
the surface and another defining an arbitrary reference direction in the
local tangent plane.  Directions are specified by polar angle 3q0 
(colatitude) measured from the local normal and azimuth angle 3f0
(longitude) measured clockwise from the reference direction in the
surface.
In general, incident flux may arrive from many portions of extended
sources, so incident radiance 2Li(3q2i, 3f2i)0 
is a function of direction.  If we consider the component of flux
2d3F2i0 arriving on the surface patch of area 2dA0
from an infinitesimal solid angle
2d3w2i0 in the direction 2(3q2i, 3f2i)0
we obtain,
.sp
.center
2d3F2i = Li cos 3q2i d3w2i dA = dEi dA0
.sp
where 2dEi = Li cos 3q2i d3w2i0 is the incident
irradiance contributed by the portion of the source found in the solid
angle 2d3w2i0 in the direction 2(3q2i, 3f2i)0.
Similarly, it is easy to see that the radiant flux emitted into an
infinitesimal solid angle 2d3w2r0 in the direction
2(3q2r,3f2r)0 equals
.sp 
.center
2d3F2r = dLr d3w2r dA0
.sp
where 2dLr(3q2r, 3f2r)0 is the radiance in
the direction 2(3q2r, 3f2r)0 due to the reflection
of the incident flux.  
The BRDF is then defined as follows,
.sp
.center
2fr(3q2i, 3f2i; 3q2r, 3f2r) = (d3F2r/d3w2r) / d3F2i = dLr/dEi0
.sp
and thus has dimension inverse steradian 2(sr-1)0.  The BRDF allows
one to obtain reflectance for any defined incident and reflected ray 
geometry simply by integrating over the specified solid angles [43].
.sp 2
.block 5
	25. INTEGRALS OVER SOLID ANGLES AND PROJECTED SOLID ANGLES. 0
.sp
	The admitting aperture of an imaging system may occupy a 
significant solid angle when seen from the point of view of the 
objects being imaged.  Furthermore we will have to deal with extended
sources.  In both cases it is necessary to integrate various 
quantities over solid angles or projected solid angles.  This can be
accomplished by double-integration with respect to the polar and azimuth 
angles (Fig. 5).  If 2X0 is the quantity to be integrated we have,
.sp
.center
2_0†2__ X d3w2 = _0†2__ _0†2__ X sin 3q2 d3q2 d3f0
.sp
and,
.sp
.center
2_0†2__ X d3W2 = _0†2__ _0†2__ X cos 3q2 sin 3q2 d3q2 d3f0
.sp
If for example 2X = 10 and the region of integration is the 
hemi-sphere above the object's surface, then
.sp
.center
2_0†2__ X d3w2 = _0†2__ _0†2__ sin 3q2 d3q2 d3f2 = 23p0
.sp
while,
.sp
.center
2_0†2__ X d3W2 = _0†2__ _0†2__ (1/2) sin 23q2 d3q2 d3f2 = 3p0
.sp
The latter result will be used in the discussion of perfectly
diffuse reflectance.
.sp 2
.block 5
	26. PERFECTLY DIFFUSE REFLECTANCE 0
.sp
	A perfectly diffuse or "lambertian" surface appears equally 
"bright" from all directions, regardless of how it is irradiated, 
and reflects all incident light [43].
Thus the reflected radiance is isotropic, that is 
2Lr0 is constant, with the same value for all directions
2(3q2r, 3f2r)0.  Also the integral of reflected
radiance over the hemi-sphere above the surface must equal the 
irradiance 2Ei0.  This implies that the BRDF for this ideal
surface. 2fr,id0 is constant, and that the radiant exitance,
2M0, equals the irradiance 2E0.  If the reflected radiance
is 2Lr0, then the radiant exitance can be found by integration,
.sp
.center
2M = _0†2__ Lr d3W2r = Lr 3p0
.sp
As a result one finds that,
.sp
.center
2fr,id = Lr / Ei = 1/3p0
.sp
If we have an extended source with radiance 2Li0, then 
the irradiance on the surface due to a small portion of solid
angle 2d3w2i0 lying in the direction 
2(3q2i, 3f2i)0 is
2dEi = Li cos 3q2i d3w2i0.  So the 
reflected radiance is,
.sp
.center
2Lr = (1/3p2) _0†2__ Li cos 3q2i d3w2i0
.sp
This is a form of Lambert's cosine law.
.sp 2
.block 5
	27.  COLLIMATED SOURCES AND THE DIRAC DELTA-FUNCTION 0
.sp
	Not all sources are extended sources.  One way to deal
with sources that are highly collimated is to treat them as
limiting cases of extended sources, with the distribution tending 
towards an impulse or delta-function.  If this is to be expressed
in a coordinate system of polar and azimuth angles one has to take
into account the non-uniform spacing of coordinates.  Consider a 
collimated source which produces an irradiance 2E00 on
a surface oriented orthogonally to the direction 
2(3q20, 3f20)0 of its rays.  Clearly the radiance
2Li0 of this source should be zero except for this direction.
One can see that the product 
3d2(3q2i - 3q20) 3d2(3f2i - 3f20)0 
will be a useful ingredient of the formula expressing 2Li0
as a function of the angles.  We have to also
make sure however that the irradiance on a surface lying orthogonal
to the rays equals 2E00.
.sp
.center 
2E0 = _0†2__ _0†2__ 2Li0 sin 3q2i d3q2i d3f2i0.
.sp
Clearly this can be accomplished if,
.sp
.center
2Li = E0 3d2(3q2i - 3q20) 3d2(3f2i - 3f20) / sin 3q200
.sp
This is called the "double-delta" representation of source radiance
for a collimated source.  It can also be written in an alternate form 
if we remember that,
.sp
.center
3d2[f(x) - f(x0)] = 3d2(x - x0) / f'(x0)0.
.sp
where 2f'(x0)0 is the derivative of 2f(x)0 evaluated at 2x = x00. 
Then,
.sp
.center
2Li = E0 3d2(cos 3q2i - cos 3q20) 3d2(3f2i - 3f20)0.
.sp 2
.block 5
	28. PERFECTLY SPECULAR REFLECTANCE 0
.sp
	A perfectly specular or "mirror-like" surface reflects light
rays in such a way that the exitant angle 3q2r0 equals the
incident angle 3q2i0 and that the incident and reflected
ray lie in a plane containing the surface normal.
The reflected radiance of a surface patch in the direction
2(3q2r, 3f2r)0 is simply the source radiance in the
corresponding reflected direction. That is,
.sp
.center
2Lr(3q2r, 3f2r) = Li(3q2r, 3f2r + 3p2)0
.sp
The surface thus forms a virtual image of the source.  From the definition of 
the BRDF we see that,
.sp
.center
2Lr = _0†2__ fr dEi = _0†2__ fr Li d 3W2i0
.sp
That is,
.sp
.center
2Lr = _0†2__ _0†2__ fr Li cos 3q2i sin 3q2i d3q2i d 3f2i0
.sp
We can satisfy the conditions stated above if we let,
.sp
.center
2fr,is = 3d2(3q2i - 3q2r) 3d2(3f2i - 3f2r + 3p2) / (sin 3q2i cos 3q2i)0
.sp
This is called the "double-delta" form of the BRDF for perfectly specular
reflectance.
Using the identity mentioned in the last section, we can write this in
an alternate form [43],
.sp
.center
2fr,is = 2 3d2(sin23q2r - sin23q2i) 3d2(3f2r - 3f2i + 3p2)0
.sp 2
.block 5
	29. ANALYSIS OF IMAGE FORMING SYSTEM0
.sp
	We will now analyze a simple image forming system (Fig. 6).
We assume that the device is properly focused, that is, those rays
originating from a particular point on the object which pass through
the entrance aperture are deflected to meet at a single point in the
image plane. Similarly, rays originating in the infinitesimal area
2dAo0 on the objects surface are projected into some area
2dAp0 in the image plane and no rays from other portions
of the object's surface will reach this area of the image.  Further,
we assume that there is no "vignetting", that is, the entrance aperture
is a constant circle of diameter 2d0 and does not become smaller for
directions which make a larger angle with the optical axis.  The effect of 
vignetting on image irradiance will be considered later.
	The exposure of film in a camera is proportional to image irradiance, 
2Ep0, and gray-levels in a digital imaging system are quantized
measurements of image irradiance.
In order to calculate image irradiance we must
first determine the flux passing through the entrance aperture
arriving from the patch of area 2dAo0 on the object.
.sp
.center
2d3F2L = dAo _0†2__ Lr d3W2r0
.sp
We will also need to know the area 2dAp0 of the image of the
patch, since image irradiance, 2Ep0, is the flux per unit area:
.sp
.center
2Ep = d3F2L/dAp0
.sp
If 3q2'r0 is the angle between the normal on the surface
and the line to the entrance aperture nodal point, while 3a0
is the angle between this line and the optical axis, then, by
equating solid angles,
.sp
.center
2(dAo cos 3q2'r)/fo2 = (dAp cos 3a2)/fp20
.sp
Consequently,
.sp
.center
2Ep = cos 3a2 (fo/fp)2 _0†2__ Lr (cos 3q2r/cos 3q2'r) d3w2r0
.sp
Here the integral is over the solid angle occupied by the entrance 
aperture as seen from the patch on the surface.  Note that 
3q2r0 in the integral will vary unless we assume that
the lens is small relative to its distance from the object.  
In this case 3q2r0 is 
approximately the same as 3q2'r0, and can be cancelled.
Furthermore, the reflected radiance, 2Lr0, will tend to be
constant and can be removed from the integral.  The solid angle
occupied by the lens as seen from the surface patch is approximately
equal to the foreshortened area 2(3p2/4) d2 cos 3a0
divided by the distance 2(fo/cos 3a0)2.
Finally then one obtains the well-known result,
.sp
.center
2Ep = (1/4) (d/fp)2 cos43a2 3p2Lr0
.sp
That is, image irradiance is proportional to scene radiance.  The 
factor of proportionality is 3p0 divided by four times the 
effective f-number 2(fp/d)0, times the fourth power of the 
cosine of the off-axis angle, 3a0.  Thus the "sensitivity" of 
such an imaging system is not uniform but is constant for a 
particular point in the image.  Vignetting introduces an additional 
variation with position in the image.  Ideally an imaging device
should be calibrated so that this variation in sensitivity as a function
of 3a0 can be removed.  
	Other kinds of imaging systems, such as microscopes or mechanical
scanners lead to somewhat different expressions.  Generally however
image irradiance is proportional to scene radiance in such systems.
At this point we should remember that scene radiance
depends on properties of the surface layer (BRDF) and the 
distribution of light-sources (source-radiance).
.sp
.center
2Lr = _0†2__ fr Li d3W2i0
.sp 2
.block 5
	210. VIEWER-ORIENTED COORDINATE SYSTEM. 0
.sp
	So far we have considered directions from the object to the
image forming system and to light sources in terms of a 1local0
coordinate system with one axis lined up with the surface normal.
Such coordinate systems will vary in orientation from place to 
place and are thus inconvenient for the specification of global
distributions such as that of source radiance.  A coordinate system
fixed in space will be more suitable, particulary if one of the axes
is lined up with the optical axis (Fig. 7).  In this 1viewer-oriented0
coordinate system we introduce polar angle, 3q0, measured from the 
z-axis and azimuth angle, 3f0, measured from the x-axis in the 
plane perpendicular to the z-axis.  Directions to sources of light
can be given using these two angles.  If the sources are far away
(in comparison to the size of the objects being imaged), then source
radiance will be a fixed function of these angles independent of the
point on the surface being considered.
.sp 2
.block 5
	211. THE SURFACE NORMAL 0
.sp
	In the local coordinate system the surface normal is easily specified 
since it lies along one of the axes or, equivalently, is the direction
corresponding to zero polar angle.  In the viewer-oriented coordinate 
system the surface normal will correspond to some direction
2(3q2n, 3f2n)0 say.
The corresponding unit vector is,
.sp
.center
2n = (cos 3f2n sin 3q2n,  sin 3f2n sin 3q2n,  cos 3q2n)0
.sp
The surface of the object may be specified by giving "elevation" 2z0
as a function of the coordinates 2x0 and 2y0.  We can give
an expression for the surface normal in terms of the first partial
derivatives of 2z0 with respect to 2x0 and 2y0, if these exist.
Let the first partial derivatives be called 2p0 and 2q0.  Then
the vectors 2(1, 0, p)0 and 2(0, 1, q)0 are tangent to the surface,
as can be seen by considering infinitesimal
steps in the 2x0 and 2y0 direction.  The surface normal is
perpendicular to all vectors in the tangent plane and so is parallel to
the cross-product of these two,
.sp
.center
2(1, 0, p) x (0, 1, q) = (-p, -q, 1)0
.sp
Thus the unit normal can be written,
.sp
.center
2n = (-p, -q, 1)/__1+p2+q2__0 
.sp
The following results are obtained by equating terms in the two 
expressions for the surface normal,
.sp
.rline 25
.spread
#2sin 3q2n = __p2+q2__/__1+p2+q2__#&#cos 3q2n = 1/__1+p2+q2__0#
.sp
.spread
#2sin 3f2n = - q/__p2+q2__#&# cos 3f2n = - p/__p2+q2__#
.sp
.rline -25
Conversely,
.sp
.rline 25
.spread
#2p = - cos 3f2n tan 3q2n __#&#q = - sin 3f2n tan 3q2n#
.rline -25
.sp 2
.block 5
	212. RELATIONSHIP BETWEEN LOCAL AND VIEWER-ORIENTED COORDINATE SYSTEMS 0
.sp
	In order to calculate the scene radiance we will integrate the 
product of the BRDF and the source radiance over all incident directions.  
Since the BRDF is specified in terms of the 1local0 coordinate system,
while the distribution of source radiance is likely to be given in the 
1viewer-oriented0  coordinate system, it will be necessary to convert 
between two.  Given the direction of the surface normal,
2(3q2n, 3f2n)0, and the direction to a portion of the source
2(3q2s, 3f2s)0, both specified in the viewer-oriented
system (Fig. 8), we have to find the incident direction
2(3q2i, 3f2i)0 and the exitent direction
2(3q2r, 3f2r)0 both specified in the local system.
Alternatively, given the surface normal and the incident direction we 
may have to find the direction to the source and the exitent direction.
Note that 3q2r = 3q2n0, since the exitent ray lies along
the z-axis in the direction towards the viewer.  Further, since we have 
excluded anisotropic surfaces, we are only interested in the 1difference0 between
3f2r0 and 3f2i0.
From the relevant spherical triangle (Fig. 9) we obtain:
.sp
.rline 10
.spread
#2cos 3q2i = cos 3q2s cos 3q2r + sin 3q2s sin 3q2r cos (3f2s - 3f2n)##(cosine formula)0#
.sp
.spread
#2sin 3q2i sin(3f2r - 3f2i) = sin 3q2s sin(3f2s - 3f2n)##(sine formula)0#
.sp
.spread
#2sin 3q2i cos(3f2r - 3f2i) = cos 3q2s sin 3q2r - sin 3q2s cos 3q2r cos(3f2s - 3f2n)##(analogue formula)0#
.rline -10
.sp
The Jacobian of the transformation from 2(3q2s, 3f2s)0
to 2(3q2i, 3f2i)0 equals, 
.sp
.center
2(3q2i/3q2s)(3f2i/3f2s) - (3q2i/3f2s)(3f2i/3q2s) = (sin 3q2s / sin 3q2i)0.
.sp
The above formulae allow us to find the incident direction 
from the source direction. 
Quite symmetrically we can also obtain the source direction from the 
incident direction:
.sp
.rline 10
.spread
#2cos 3q2s = cos 3q2i cos 3q2r + sin 3q2i sin 3q2r cos(3f2r - 3f2i)##(cosine formula)0#
.sp
.spread
#2sin 3q2s sin(3f2s - 3f2n) = sin 3q2i sin (3f2r - 3f2i)##(sine formula)0#
.sp
.spread
#2sin 3q2s cos(3f2s - 3f2n) = cos 3q2i sin 3q2r - sin 3q2i cos 3q2r cos (3f2r - 3f2i)##(analogue formula)0#
.rline -10
.sp
The Jacobian of the transformation from 2(3q2i, 3f2i)0
to 2(3q2s, 3f2s)0 equals,
.sp
.center
2(3q2s/3q2i)(3f2s/3f2i) - (3f2s/3q2i)(3q2s/3f2i) = (sin 3q2i / sin 3q2s)0.
.sp 2
.block 5
	213. SCENE RADIANCE0
.sp
	It follows from the definition of the BRDF that reflected
radiance can be written as the following integral,
.sp
.center
2Lr = _0†2__ fr Li d3W2i = _0†2__ fr Li cos 3q2i d3w2i0
.sp
Using polar and azimuth angles this becomes,
.sp
.center
2Lr(3q2n, 3f2n) = _0†2__ _0†2__ fr(3q2i, 3f2i; 3q2r, 3f2r) Li(3q2s, 3f2s) cos 3q2i sin 3q2i d3q2i d3f2i0
.sp
Here we integrate over all possible incident directions 
2(3q2i, 3f2i)0 and calculate source direction 
2(3q2s, 3f2s)0
from the given surface normal 2(3q2n, 3f2n)0 and the 
incident direction.  The inner integral has the limits 200 to 3p2/20
for 3q2i0, corresponding to directions within the hemi-sphere
visible from the surface.  The integration can be extended to the full
sphere of directions if the integrand is forced to be zero when 
3q2i0 lies between 3p2/20 and 3p0.  This can be
accomplished by replacing 2cos 3q2i0 by 
2max[0, cos 3q2i]0.  Hence
.sp
.center
2Lr = _0†2__ _0†2__ fr Li max[0, cos 3q2i] sin 3q2i d3q2i d3f2i0
.sp
Since the integral now is over the full sphere of directions it can be 
rewritten using any other set of polar and azimuth angles.
Using the 1viewer-oriented0 coordinate system for example we obtain,
.sp
.center
2Lr = _0†2__ _0†2__ fr Li max[0, cos 3q2i] sin 3q2s d3q2s d3f2s0
.sp
That is,
.sp
.center
2Lr(3q2n, 3f2n) = _0†2__ _0†2__ fr(3q2i, 3f2i; 3q2r, 3f2r) Li(3q2s, 3f2s) max[0, cos 3q2i] sin 3q2s d3q2s d3f2s0
.sp
Here we integrate over all possible source directions 2(3q2s, 3f2s)0 and calculate incident directions 2(3q2i, 3f2i)0
from the given surface normal 2(3q2n, 3f2n)0 and the 
source direction.  We now have two convenient forms for the calculation of
scene radiance.  We proceed to calculate reflectance maps for a few simple
combinations of BRDF and distributions of source radiance.
.sp 2
.block 5
	214. COLLIMATED SOURCE, LAMBERTIAN REFLECTANCE 0
.sp
	In this case 2fr = 1/3p0 and 
2Li = E0 3d2(3q2s - 3q20) 3d2(3f2s - 3f20) / sin 3q200, where 2E00 
is the irradiance measured perpendicular to the beam of light arriving from 
source direction 2(3q20, 3f20)0.  
Substituting into the second form of the expression for scene radiance
we obtain,
.sp
.center
2Lr = _0†2__ _0†2__ (E0/3p0) 3d2(3q2s - 3q20) 3d2(3f2s - 3f20) max[0, cos 3q2i] (sin 3q2s / sin 3q20) d3q2s d3f2s0
.sp
this becomes,
.sp
.center
2Lr = (E0/3p2) max[0, cos 3q2i]0
.sp
where 2cos 3q2i = cos 3q2r cos 3q20 + sin 3q2r sin 3q20 cos(3f20 - 3f2n)0.  Note that
2cos(3f20 - 3f2n) = cos 3f20 cos 3f2n - sin 3f20 sin 3f2n0. To obtain the reflectance map, scene radiance
as a function of surface gradient, we can substitute expressions in 2p0
and 2q0 for these trigonometric expressions.  The result is,
.sp
.center
2R(p, q) = (E0/3p2) max[0, (1+p0p+q0q) / ( __1+p2+q2__ __1+p02+q02__ )]0
.sp
Where 
.rline 30
.spread
#2p0 = - cos 3f20 tan 3q20 __#&#q0 = - sin 3f20 tan 3q200#
.rline -30
.sp
The significance of 2p00 and 2q00 is that a surface element with
gradient 2(p0, q0)0 has its surface normal parallel to the direction
of the incident light rays.
.sp 2
.block 5
	215. UNIFORM SOURCE, LAMBERTIAN REFLECTANCE0
.sp
	In this case, 2fr = 1/3p0 and
2Ls = L00 say.  Substituting into the first form
of the expression for scene radiance we obtain,
.sp
.center
2Lr = _0†2__ _0†2__ (L0/3p2) cos 3q2i sin 3q2i d3q2i d3f2i0
.sp
This becomes,
.sp
.center
2Lr = L0 _0†2__ sin 23q2i d3q2i = L00
.sp
Not surprisingly, the reflected radiance is independent of the surface
orientation in this case.
.sp 2
.block 5
	216. COLLIMATED SOURCE, SPECULAR REFLECTANCE0
.sp
	In this case 2fr = 3d2(3q2i - 3q2r) 3d2(3f2i - 3f2r + 3p2) / (sin 3q2i cos 3q2i)0 
and 2Li = 3d2(3q2s - 3q20) 3d2(3f2s - 3f20) / sin 3q200.  
Using the first form of the expression for scene radiance we obtain,
.sp
.center
2Lr = _0†2__ _0†2__ 3d2(3q2i - 3q2r) 3d2(3f2i - 3f2r + 3p2) 3d2(3q2s - 3q20) 3d2(3f2s - 3f20) / sin 3q20 d3q2i d3f2i0
.sp
That is,
.sp
.center
2Lr = 3d2(3q2s' - 3q20) 3d2(3f2s' - 3f20) / sin 3q200
.sp 
where 3q2s'0 and 3f2s'0 are the values of 3q2s0 and 3f2s0 
corresponding to 3q2i = 3q2r0 and 3f2i = 3f2r + 3p0.
Using the equations for the coordinate transformations one quickly finds that
3q2s'0 = 2 3q2r0 and 3f2s' = 3f2n0. Thus,
.sp
.center
2Lr = 3d2(2 3q2r - 3q20) 3d2(3f2n - 3f20) / sin 3q200
.sp
Or finally,
.sp
.center
2Lr(3q2n, 3f2n) = (1/2) 3d2(3q2n - 3q20/2) 3d2(3f2n - 3f20) / sin 3q200
.sp
To express this as a function of 2p0 and 2q0 we have to remember that
.sp
.center
3d2[f(x, y) - f(x0, y0)] 3d2[g(x, y) - g(x0, y0)] = 3d2(x - x0) 3d2(y - y0) / J(x0,y0)0
.sp
where 2J(x,y)0 is the Jacobian of the transformation from 2(x,y)0 to 2(f,g)0:
.sp
.center
2J(x,y) = (f/x)(g/y) - (f/y)(g/x)0
.sp
The Jacobian of the transformation from 2(p, q)0 to 2(3q2n, 3f2n)0 is,
.sp
.center
2J(p, q) = 1/[ __p2 + q2__ (1 + p2 + q2)]0
.sp
Let
.sp
.rline 30
.spread
#2p1 = - cos 3f20 tan 3q20/2#&#q1 = - sin 3f20 tan 3q20/20#
.rline -30
.sp
Then, noting that 2sin 3q20 = 2 sin 3q20/2 cos 3q20/20 one can write,
.sp
.center
2 sin 3q20 = 2 __p12 + q12__ /(1 + p12 + q12)0
.sp
and therefore,
.sp
.center
2R(p, q) = (1/4) 3d2(p - p1) 3d2(q - q1) (1 + p12 + q12)20
.sp
The significance of 2p10 and 2q10 is that a surface element with
gradient 2(p1, q1)0 is oriented to specularly reflect the collimated
source towards the viewer.  This gradient can be related to the gradient
2(p0, q0)0 introduced earlier.
.sp
.rline 10
.spread
#22p1 = p0 ( __1+p02+q02__ - 1) / (p02+q02)#&#q1 = q0 ( __1+p02+q02__ - 1) / (p02+q02)0#
.sp
.rline -10
The point 2(p1, q1)0 is approximately half as far from the origin, 2(0, 0)0, as
the point 2(p0, q0)0, when the latter is not too far from the origin.
.sp 2
.block
	217. UNIFORM SOURCE, SPECULAR REFLECTANCE0
.sp
	It is easy to see that in this case the scene radiance will
be constant and equal to the source radiance.
.sp
.center
2Lr = L00
.sp
This is the same result as the one we obtained for the uniform source 
and lambertian reflectance.  Thus a diffuse surface appears just as
bright as a specular surface if both are viewed with uniform illumination.
In fact, all surfaces reflecting the same fraction, 3r2 say, of the total
incident light will appear equally bright under this illumination
condition.
.SP 2
.BLOCK 5
	218. HEMI-SPHERICAL UNIFORM SOURCE, LAMBERTIAN REFLECTANCE0
.sp
	In this case (Fig. 10),
.sp
.rline 40
.spread
#2Li(3q2s, 3f2s) = L0#for#3q2s < 90o0#
.spread
#2Li(3q2s, 3f2s) = 0#for#3q2s > 90o0#
.rline -40
.sp
To evaluate the double-integral for scene radiance it is helpful to
know the value 3q2i'0 of 3q2i0 which corresponds
to the horizon 3q2s = 90o0.  From the coordinate transformation
equations one can easily show that,
.sp
.center
2cot 3q2i' = - tan 3q2r cos (3f2r - 3f2i)0
.sp
For 3f2r - 3p2/2 < 3f2i < 3f2r + 3p2/20,
the horizon cutoff will occur for 3q2i' > 90o0 and can be
ignored.  For the other half of the range of 3f2i0, this cutoff
occurs for 3q2i' < 90o0 and must be considered. Now,
.sp
.center
2_0†2__ cos 3q2i sin 3q2i d3q2i = 1/20
.sp
while,
.sp
.center
2_0†2__ cos 3q2i sin 3q2i d3q2i = (1 - cos 2 3q2i') / 4 = sin23q2i' / 20
.sp
If 2cot 3q2i' = - tan 3q2r cos(3f2r - 3f2i)0, then,
2sin23q2i' = 1 / [1 + tan23q2r cos2(3f2r - 3f2i)]0
.sp
Now,
.sp
.center
2Lr = _0†2__ _0†2__ fr Li cos 3q2i sin 3q2i d3q2i d3f2i0
.sp
Substituting for 2fr0 and 2Li0 and splitting the range of integration we get,
.sp
.center
2Lr = (L0/23p2) [ _0†2__ sin23q2i' d3f2i + _0†2__ d3f2i + _0†2__ sin23q2i' d3f2i]0
.sp
The integral in the middle is just equal to 3p0, while the outer
two integrals add up to,
.sp
.center
2 _0†2__ 1 / [1 + tan23q2r cos23f2] d3f0
.sp
which equals,
.sp
.center
2 [cos 3q2r tan-1 (cos 3q2r tan 3f2)]__ = 3p2 cos 3q2r0
.sp
Adding up all the terms we finally get,
.sp
.center
2Lr(3q2n, 3f2n) = L0 (1 + cos 3q2n) / 2 = L0 cos23q2n/20
.sp
This is the result found by Brookes [44].  From it one can immediately determine
the reflectance map,
.sp
.center
2R(p, q) = (L0/2) (1 + 1/__1+p2+q2__ )0
.sp 2
.block 5
	219. SUMMARY AND CONCLUSIONS0.
.sp
	We have shown that image irradiance is proportional to scene radiance
and that scene radiance depends on surface orientation.  The reflectance map
gives scene radiance as a function of the gradient.  It can be calculated
from the bidirectional reflectance-distribution function (BRDF) and the 
distribution of source radiance.   Several special cases were worked out in
detail.  Each could have been developed more easily by a direct method, but was
obtained from the general expression for scene radiance to illustrate the
technique.  The general expression allows one to find the reflectance map
even if the source radiance distribution or the BRDF is only given numerically.
.sp 2
.block 5
	220. ACKNOWLEDGEMENTS.0
.sp
	The authors would like to thank H.-H. Nagel, B. Neumann, B. Radig and
L. Dreschler of the University of Hamburg, who helped debug some of the ideas.  
Discussions with M. Brady and M. Brooks of the University 
of Essex were very helpful.
We are also grateful for text preparation by Blenda Horn and 
drawings by Karen Prendergast.
.sp
	And Puma said Mirr.....
.sp 2
.block 5
	2REFERENCES0
.rinden 3
.sp
.undent 3
[1]__Diggelen, J. van (1951) "A Photometric Investigation of the Slopes
and Heights of the Ranges of Hills in the Maria of the Moon,"
Bulletin of the Astronomical Institute of the Netherlands, July 1951.
.sp
.undent 3
[2]__Rindfleisch, T. (1966) "Photometric Method for Lunar Topography,"
Photogrammetric Engineering, March 1966.
.sp
.undent 3
[3]__Horn, B. K. P. (1975) "Determining Shape from Shading," Chapter 4,
in Winston, P. H. (Ed) The Psychology of Computer Vision,
McGraw-Hill, N. Y.
.sp
.undent 3
[4]__Horn, B. K. P. (1977) "Understanding Image Intensities,"
Artificial Intelligence, Vol. 8, No. 11, pp 201-231.
.sp
.undent 3
[5]__Woodham, R. J. (1977) "A Cooperative Algorithm for Determining
Surface Orientation from a Single View," Proc. 5th Int. Joint Conf.
on Artif. Intell., M. I. T., Cambridge, Mass, August 1977, pp 635-641.
.sp
.undent 3
[6]__Woodham, R. J. (1978) "Reflectance Map Techniques for Analyzing
Surface Defects in Metal Castings," TR-457, A. I. Laboratory, M. I. T.,
Cambridge, Mass.
.sp
.undent 3
[7]__Woodham, R. J. (1978) "Photometric Stereo: A Reflectance Map Technique 
for Determining Surface Orientation from Image Intensity",   
Proceedings of SPIE's 22nd Annual Technical Symposium, 
Vol. 155, August 1978.
.sp 
.undent 3
[8]__Horn, B. K. P. & Woodham, R. J. (1978) "Determining Shape and
Reflectance using Multiple Images," A. I. Memo 485 (?),
M. I. T., Cambridge, Mass. August 1978.
.sp 
.undent 3
[9]__Gilpin, F. H. (1910) "Effect of the variation of the incident angle on 
the coefficients of diffuse reflection," 
Trans. Illum. Eng. Soc., Vol. 5, pp 854-873.
.rinden -3
.rinden 4
.sp
.undent 4
[10]__Knowles Middleton, W. E. & Mungall, A. G. (1952) "The luminous
directional reflectance of snow,"Journal of the Optical
Society of America, Vol. 42, No. 8, August 1952, pp 572-579.
.sp
.undent 4
[11]__Fedoretz, V. A. (1952) "Photographic Photometry of the Lunar Surface,"
Publ. Kharkov Obs., Vol. 2, pp 49-172.
.sp
.undent 4
[12]__Van Diggelen, J. (1959) "Photometric Properties of Lunar Crater Floors,"
Rech. Obs. Utrecht, Vol. 14, pp 1-114.
.sp
.undent 4
[13]__Minnaert, M. (1961) "Photometry of the Moon," in
Planets and Satellites, G. Kuiper & B. Middlehurst (eds),
Vol. 3, Univ. of Chicago Press, Chicago, pp 213-248.
.sp
.undent 4
[14]__Fesenkov, V. (1962) "Photometry of the Moon," in
Physics and Astronomy of the Moon, Z. Kopal (ed),
Academic Press, New York, pp 99-130.
.sp
.undent 4
[15]__Hapke, B. & Van Horn, H. (1963) "Photometric Studies of Complex Surfaces, with 
Applications to the Moon," Journal of Geophysical Research, 
Vol. 68, No. 15, pp 4545-4570.
.sp
.undent 4
[16]__De Vaucouleurs, G. (1964) "Geometric and Photometric Parameters of the
Terrestrial Planets," ICARUS, Vol. 3, pp 187-235.
.sp
.undent 4
[17]__Van Diggelen, J. (1965) "The radiance of lunar objects near opposition,"
Planetary Space Science, Vol. 13, pp 271-279.
.sp
.undent 4
[18]__Oetking, P. (1966) "Photometric Studies of Diffusely Reflecting Surfaces
with Applications to the Brightness of the Moon,"
Journal of Geophysical Research, Vol. 71, No. 10, May 1966,
pp 2505-2515.
.sp
.undent 4
[19]__Rennilson, J. J., Holt, H. E. & Morris, E. C. (1968)
"1In Situ0 Measurements of the Photometric Properties of an Area on the Lunar Surface,"
Journal of the Optical Society of America, Vol. 58, No. 6,
June 1968, pp 747-755.
.sp
.undent 4
[20]__Patterson, E. M., Sheldon, C. E. & Stockton, B. H. (1977) "Kubelka-Munk
optical properties of a barium surfate white reflectance standard,"
Applied Optics, Vol. 16, No. 3, March 1977, pp 729-732.
.sp
.undent 4
[21]__Tucker, C. J. (1977) "Asymptotic nature of grass canopy spectral reflectance,"
Applied Optics, Vol. 16, No. 5, May 1977, pp 1151-1156.
.sp
.undent 4
[22]__Minnaert, M. (1941) "The Reciprocity Principle in Lunar Photometry,"
Astrophysical Journal, Vol. 93, pp 403-410. 
.sp
.undent 4
[23]__Van de Hulst, H. C. (1957) Light Scattering by Small Particles,"
John Wiley & Sons, New York.
.sp
.undent 4
[24]__Hapke, B. W. (1963) "A Theoretical Photometric Function for the Lunar Surface,"
Journal of Geophysical Research, Vol 68., No. 15, August 1963,
pp 4571-4586.
.sp
.undent 4
[25]__Melamed, N. T. (1963) "Optical Properties of Powders. Part I. Optical Absorption
Coefficients and the Absolute Value of Diffuse Reflectance. Part II.
Properties of Luminescent Powders," Journal of Applied Optics,
Vol 34, No. 3, March 1963, pp 560-570.
.sp
.undent 4
[26]__Hapke, B. (1966) "An Improved Theoretical Lunar Photometric Function,"
The Astronomical Journal, Vol. 71, No. 5, June 1966, pp 333-339.
.sp
.undent 4
[27]__Torrance, K. E., Sparrow, E. M. & Birkebak, R. C. (1966) 
"Polarization, directional distribution,
and off-specular peak phenomena in light reflected from roughened surfaces,"
Journal of the Optical Society of America, Vol 56, No. 7, 
July 1966, pp 916-925.
.sp
.undent 4
[28]__Torrance, K. E. & Sparrow, E. M. (1967) "Theory for
off-specular reflection from roughened surfaces," Journal
of the Optical Society of America, Vol. 57, No. 9,
September 1967, pp 1105-1114.
.sp
.undent 4
[29]__Trowbridge, T. S. & Reitz, K. P. (1975) "Average irregularity representation of a
rough surface for ray reflection",Journal of the Optical
Society of America, Vol. 65, No. 5, May 1975, pp 531-536.
.sp
.undent 4
[30]__Simmons, E. L. (1975) "Diffuse reflectance spectroscopy: a comparison 
of the theories," Applied Optics, Vol. 14, No. 6, June 1975, pp 1380-1336.
.sp
.undent 4
[31]__Simmons, E. L. (1975) "A refinement of the simplified particle model theory
of diffuse reflectance spectroscopy," Optica Acta, Vol. 22, No. 1, pp 71-77.
.sp
.undent 4
[32]__Simmons, E. L. (1975) "Modification of the particle-model theory of diffuse
reflectance properties of powdered samples," Journal of Applied Physics,
Vol. 46, No. 1, January 1975, pp 344-348.
.sp
.undent 4
[33]__Simmons, E. L. (1976) "Particle model theory of diffuse reflectance:
effect of nonuniform particle size," Applied Optics,
Vol. 15, No. 3, March 1976, pp 603-604.
.sp
.undent 4
[34]__Tucker, C. J. & Garratt, M. W. (1977) "Leaf optical system modelled as a
stochastic process," Applied Optics, Vol. 16, No. 3, March 1977, 
pp 635-642.
.sp
.undent 4
[35]__Plass, G. N., Kattawar, G. W. & Guinn Jr., J. A. (1977)
"Isophotes of sunlight glitter on a wind-ruffled sea,"
Applied Optics, Vol. 16, No. 3, March 1977, pp 643-653.
.sp
.undent 4
[36]__Gouraud, H. (1971) "Computer display of curved surfaces,"
Technical Report 113, UTEC-CSC-71, 
Computer Science, University of UTAH, Salt Lake City, Utah.
.sp
.undent 4
[37]__Bui Tuong-Phong (1973) "Illumination for computer-generated images,"
Technical Report 129, UTEC-CSC-73, 
Computer Science, University of UTAH, Salt Lake City, Utah.
.sp
.undent 4
[38]__Blinn, J. F. (1977) 
"Models of light reflection for computer synthesized pictures," 
SIGGRAPH '77, Proc. ACM, Computer Graphics, Vol. 11, No. 2,
July 1977, pp 192-198.
.sp
.undent 4
[39]__Wendlandt, W. W. & Hecht, H. G. (1966) Reflectance Spectroscopy,
Interscience, New York.
.sp
.undent 4
[39]__Wendlandt, W. W. (ed) (1968) Modern Aspects of Reflectance Spectroscopy,
Plenum, New York.
.sp
.undent 4
[41]__Kortuem, G. (1969) Reflectance Spectroscopy, trans. by J. E. Lohr,
Springer-Verlag, Berlin.
.sp
.undent 4
[42]__Spencer, D. E. & Gaston, E. G. (1975) "Current definitions of reflectance,"
Journal of the Optical Society of America, Vol. 65, No. 10,
October 1975, pp 1129-1132.
.sp
.undent 4
[43]__Nicodemus, F. E., Richmond, J. C. & Hsia, J. J., Ginsberg, I. W.
& Limperis, T. (1977)
"Geometrical Considerations and Nomenclature for Reflectance,"
NBS Monograph 160, National Bureau of Standards, U. S. Department
of Commerce, Washington, D. C., October 1977.
.sp
.undent 4
[44]__Brooks, M. J. (1978)
"Investigating the Effects of Planar Light Sources," CSM 22,
Dept. of Computer Science, Essex University.
.sp
.rinden -4
.end

